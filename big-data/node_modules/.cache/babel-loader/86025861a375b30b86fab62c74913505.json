{"remainingRequest":"C:\\Users\\18167\\Desktop\\big-data\\node_modules\\.store\\babel-loader@8.4.1\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\18167\\Desktop\\big-data\\node_modules\\.store\\cache-loader@4.1.0\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\18167\\Desktop\\big-data\\node_modules\\.store\\vue-loader@15.11.1\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\18167\\Desktop\\big-data\\src\\views\\emergencyDispatch\\gugeMap.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\18167\\Desktop\\big-data\\src\\views\\emergencyDispatch\\gugeMap.vue","mtime":1739146273584},{"path":"C:\\Users\\18167\\Desktop\\big-data\\babel.config.js","mtime":1725678814000},{"path":"C:\\Users\\18167\\Desktop\\big-data\\node_modules\\.store\\cache-loader@4.1.0\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\18167\\Desktop\\big-data\\node_modules\\.store\\babel-loader@8.4.1\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\18167\\Desktop\\big-data\\node_modules\\.store\\cache-loader@4.1.0\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\18167\\Desktop\\big-data\\node_modules\\.store\\vue-loader@15.11.1\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5pdGVyYXRvci5jb25zdHJ1Y3Rvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5pdGVyYXRvci5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5pdGVyYXRvci5tYXAuanMiOwppbXBvcnQgeyByYXRlLCBnZXRsaXN0IH0gZnJvbSAnQC9hcGknOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkdvb2dsZU1hcCIsCiAgcHJvcHM6IHsKICAgIGNhbnRpbmRpemhpOiBPYmplY3QgLy8g5Y2V5Liq5a+56LGhCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbWFwOiBudWxsLAogICAgICAvLyDlnLDlm77lrp7kvosKICAgICAgbWFya2VyczogW10sCiAgICAgIC8vIOW9k+WJjeagh+iusOaVsOe7hAogICAgICBpc01hcExvYWRlZDogZmFsc2UsCiAgICAgIC8vIOeUqOS6juagh+iusOWcsOWbvuaYr+WQpuWKoOi9veWujOaIkAogICAgICBzaG93Q3VzdG9tSW5mb1dpbmRvdzogZmFsc2UsCiAgICAgIC8vIOaOp+WItuiHquWumuS5ieW8ueeql+aYvuekugogICAgICBzZWxlY3RlZExvY2F0aW9uOiB7fSwKICAgICAgLy8g5b2T5YmN6YCJ5Lit55qE5L2N572u5L+h5oGvCiAgICAgIGN1cnJlbnRSYXRpbmc6IDAsCiAgICAgIC8vIOW9k+WJjeivhOWIhgogICAgICBpbmZvV2luZG93UG9zaXRpb246IHsKICAgICAgICB0b3A6ICcwcHgnLAogICAgICAgIGxlZnQ6ICcwcHgnCiAgICAgIH0KICAgIH07CiAgfSwKICB3YXRjaDogewogICAgY2FudGluZGl6aGk6IHsKICAgICAgaGFuZGxlcihuZXdWYWwpIHsKICAgICAgICBjb25zb2xlLmxvZyhuZXdWYWwsICJuZXdWYWwiKTsKICAgICAgICBpZiAodGhpcy5pc01hcExvYWRlZCAmJiBuZXdWYWwgJiYgbmV3VmFsLmxhdCAmJiBuZXdWYWwubG5nKSB7CiAgICAgICAgICBuZXdWYWwubGF0ID0gTnVtYmVyKG5ld1ZhbC5sYXQpOwogICAgICAgICAgbmV3VmFsLmxuZyA9IE51bWJlcihuZXdWYWwubG5nKTsKICAgICAgICAgIG5ld1ZhbC5zY29yZSA9IE51bWJlcihuZXdWYWwuc2NvcmUpOwogICAgICAgICAgdGhpcy5hbmltYXRlUGFuVG8obmV3VmFsKTsgLy8g5L2/55So5Yqo55S75bmz56e75Yiw5L2N572uCiAgICAgICAgfQogICAgICB9LAogICAgICBpbW1lZGlhdGU6IHRydWUgLy8g5Yid5aeL5Yqg6L295pe25Lmf6Kem5Y+RCiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5pbml0TWFwKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBpbml0TWFwKCkgewogICAgICAvLyDnoa7kv50gRE9NIOW3suWKoOi9veW5tuWtmOWcqAogICAgICBjb25zdCBtYXBDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibWFwIik7CiAgICAgIGlmICghbWFwQ29udGFpbmVyKSB7CiAgICAgICAgY29uc29sZS5lcnJvcigi5Zyw5Zu+5a655Zmo5pyq5om+5Yiw77yBIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRyeSB7CiAgICAgICAgLy8g5Yid5aeL5YyW5Zyw5Zu+77yM6buY6K6k5Lit5b+D54K56K6+572u5Li654ix5bCU5YWwCiAgICAgICAgdGhpcy5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKG1hcENvbnRhaW5lciwgewogICAgICAgICAgY2VudGVyOiB7CiAgICAgICAgICAgIGxhdDogNTMuNDEyOTEsCiAgICAgICAgICAgIGxuZzogLTguMjQzODkKICAgICAgICAgIH0sCiAgICAgICAgICAvLyDpu5jorqTkuK3lv4PlnZDmoIcKICAgICAgICAgIHpvb206IDcgLy8g5Yid5aeL57yp5pS+57qn5YirCiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5pc01hcExvYWRlZCA9IHRydWU7IC8vIOagh+iusOWcsOWbvuWKoOi9veaIkOWKnwoKICAgICAgICAvLyDlpoLmnpzliJ3lp4sgYGNhbnRpbmRpemhpYCDlrZjlnKjvvIzlubPnp7vop4bop5LliLDmjIflrprkvY3nva4KICAgICAgICBpZiAodGhpcy5jYW50aW5kaXpoaSAmJiB0aGlzLmNhbnRpbmRpemhpLmxhdCAmJiB0aGlzLmNhbnRpbmRpemhpLmxuZykgewogICAgICAgICAgdGhpcy5hbmltYXRlUGFuVG8odGhpcy5jYW50aW5kaXpoaSk7CiAgICAgICAgfQoKICAgICAgICAvLyDmt7vliqDlnLDlm77np7vliqjkuovku7bnm5HlkKzvvIznp7vliqjml7blhbPpl63lvLnnqpcKICAgICAgICB0aGlzLm1hcC5hZGRMaXN0ZW5lcignZHJhZ3N0YXJ0JywgKCkgPT4gewogICAgICAgICAgdGhpcy5zaG93Q3VzdG9tSW5mb1dpbmRvdyA9IGZhbHNlOwogICAgICAgIH0pOwoKICAgICAgICAvLyDmt7vliqDlnLDlm77nvKnmlL7kuovku7bnm5HlkKzvvIznvKnmlL7ml7blhbPpl63lvLnnqpcKICAgICAgICB0aGlzLm1hcC5hZGRMaXN0ZW5lcignem9vbV9jaGFuZ2VkJywgKCkgPT4gewogICAgICAgICAgdGhpcy5zaG93Q3VzdG9tSW5mb1dpbmRvdyA9IGZhbHNlOwogICAgICAgIH0pOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoIuWcsOWbvuWKoOi9veWksei0pe+8miIsIGVycm9yKTsKICAgICAgICB0aGlzLnJldHJ5TG9hZE1hcCgpOyAvLyDlpoLmnpzliqDovb3lpLHotKXvvIzlsJ3or5Xph43mlrDliqDovb0KICAgICAgfQogICAgfSwKICAgIHJldHJ5TG9hZE1hcCgpIHsKICAgICAgLy8g6YeN5paw5bCd6K+V5Yqg6L295Zyw5Zu+CiAgICAgIGNvbnNvbGUubG9nKCLlsJ3or5Xph43mlrDliqDovb3lnLDlm74uLi4iKTsKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgdGhpcy5pbml0TWFwKCk7CiAgICAgIH0sIDEwMDApOyAvLyDlu7bov58gMSDnp5Lph43mlrDlsJ3or5UKICAgIH0sCiAgICBhbmltYXRlUGFuVG8obG9jYXRpb24pIHsKICAgICAgY29uc29sZS5sb2cobG9jYXRpb24sICJsb2NhdGlvbnMiKTsKCiAgICAgIC8vIOS9v+eUqCBzZXRJbnRlcnZhbCDlrp7njrDlubPnp7vliqjnlLsKICAgICAgY29uc3Qgc3RlcHMgPSAzMDsgLy8g5Yqo55S755qE5q2l5pWwCiAgICAgIGNvbnN0IGludGVydmFsVGltZSA9IDIwOyAvLyDmr4/mraXpl7TpmpTnmoTml7bpl7TvvIjmr6vnp5LvvIkKCiAgICAgIGNvbnN0IHN0YXJ0TGF0ID0gdGhpcy5tYXAuZ2V0Q2VudGVyKCkubGF0KCk7CiAgICAgIGNvbnN0IHN0YXJ0TG5nID0gdGhpcy5tYXAuZ2V0Q2VudGVyKCkubG5nKCk7CiAgICAgIGNvbnN0IGRlbHRhTGF0ID0gKGxvY2F0aW9uLmxhdCAtIHN0YXJ0TGF0KSAvIHN0ZXBzOwogICAgICBjb25zdCBkZWx0YUxuZyA9IChsb2NhdGlvbi5sbmcgLSBzdGFydExuZykgLyBzdGVwczsKICAgICAgbGV0IGN1cnJlbnRTdGVwID0gMDsKICAgICAgY29uc3QgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgY3VycmVudFN0ZXArKzsKICAgICAgICBjb25zdCBsYXQgPSBzdGFydExhdCArIGRlbHRhTGF0ICogY3VycmVudFN0ZXA7CiAgICAgICAgY29uc3QgbG5nID0gc3RhcnRMbmcgKyBkZWx0YUxuZyAqIGN1cnJlbnRTdGVwOwogICAgICAgIHRoaXMubWFwLnNldENlbnRlcih7CiAgICAgICAgICBsYXQsCiAgICAgICAgICBsbmcKICAgICAgICB9KTsKICAgICAgICBpZiAoY3VycmVudFN0ZXAgPj0gc3RlcHMpIHsKICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpOwogICAgICAgICAgdGhpcy5tYXAuc2V0Q2VudGVyKHsKICAgICAgICAgICAgbGF0OiBsb2NhdGlvbi5sYXQsCiAgICAgICAgICAgIGxuZzogbG9jYXRpb24ubG5nCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMubWFwLnNldFpvb20oMTgpOyAvLyDmlL7lpKflnLDlm74KCiAgICAgICAgICAvLyDmm7TmlrDmoIforrAKICAgICAgICAgIHRoaXMuY2xlYXJNYXJrZXJzKCk7CiAgICAgICAgICB0aGlzLmFkZE1hcmtlcihsb2NhdGlvbik7CiAgICAgICAgfQogICAgICB9LCBpbnRlcnZhbFRpbWUpOwogICAgfSwKICAgIGFkZE1hcmtlcihsb2NhdGlvbikgewogICAgICBjb25zdCBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHsKICAgICAgICBwb3NpdGlvbjogewogICAgICAgICAgbGF0OiBsb2NhdGlvbi5sYXQsCiAgICAgICAgICBsbmc6IGxvY2F0aW9uLmxuZwogICAgICAgIH0sCiAgICAgICAgbWFwOiB0aGlzLm1hcCwKICAgICAgICB0aXRsZTogbG9jYXRpb24udGl0bGUgfHwgIkxvY2F0aW9uIgogICAgICB9KTsKCiAgICAgIC8vIOWIm+W7uuS4gOS4quWFqOWxgOeahCBvdmVybGF5IOWunuS+iwogICAgICBjb25zdCBvdmVybGF5ID0gbmV3IGdvb2dsZS5tYXBzLk92ZXJsYXlWaWV3KCk7CiAgICAgIG92ZXJsYXkuZHJhdyA9IGZ1bmN0aW9uICgpIHt9OwogICAgICBvdmVybGF5LnNldE1hcCh0aGlzLm1hcCk7CiAgICAgIG1hcmtlci5hZGRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coIk1hcmtlciBjbGlja2VkIik7CiAgICAgICAgY29uc3QgbWFya2VyUG9zaXRpb24gPSBtYXJrZXIuZ2V0UG9zaXRpb24oKTsKICAgICAgICBjb25zdCBjYWxjdWxhdGVQb3NpdGlvbiA9ICgpID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJDYWxjdWxhdGluZyBwb3NpdGlvbiIpOwogICAgICAgICAgY29uc3QgcHJvamVjdGlvbiA9IG92ZXJsYXkuZ2V0UHJvamVjdGlvbigpOwogICAgICAgICAgY29uc3QgcG9pbnQgPSBwcm9qZWN0aW9uLmZyb21MYXRMbmdUb0NvbnRhaW5lclBpeGVsKG1hcmtlclBvc2l0aW9uKTsKICAgICAgICAgIHRoaXMuc2VsZWN0ZWRMb2NhdGlvbiA9IGxvY2F0aW9uOwogICAgICAgICAgdGhpcy5jdXJyZW50UmF0aW5nID0gbG9jYXRpb24udXNlclJhdGluZyB8fCAwOwogICAgICAgICAgdGhpcy5pbmZvV2luZG93UG9zaXRpb24gPSB7CiAgICAgICAgICAgIHRvcDogYCR7cG9pbnQueX1weGAsCiAgICAgICAgICAgIGxlZnQ6IGAke3BvaW50Lnh9cHhgCiAgICAgICAgICB9OwogICAgICAgICAgdGhpcy5zaG93Q3VzdG9tSW5mb1dpbmRvdyA9IHRydWU7CiAgICAgICAgfTsKCiAgICAgICAgLy8g5aaC5p6cIHByb2plY3Rpb24g5bey57uP5YeG5aSH5aW9CiAgICAgICAgaWYgKG92ZXJsYXkuZ2V0UHJvamVjdGlvbigpKSB7CiAgICAgICAgICBjYWxjdWxhdGVQb3NpdGlvbigpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyDlpoLmnpwgcHJvamVjdGlvbiDov5jmsqHlh4blpIflpb3vvIznrYnlvoXlroPlh4blpIflpb3lubbnq4vljbPorqHnrpcKICAgICAgICAgIG92ZXJsYXkuYWRkTGlzdGVuZXIoJ2FkZCcsICgpID0+IHsKICAgICAgICAgICAgc2V0VGltZW91dChjYWxjdWxhdGVQb3NpdGlvbiwgMTAwKTsgLy8g5re75Yqg5bCP5bu26L+f56Gu5L+dIHByb2plY3Rpb24g5a6M5YWo5YeG5aSH5aW9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICB0aGlzLm1hcmtlcnMucHVzaChtYXJrZXIpOwogICAgfSwKICAgIGNsZWFyTWFya2VycygpIHsKICAgICAgLy8g5riF6Zmk5Zyw5Zu+5LiK55qE5qCH6K6wCiAgICAgIHRoaXMubWFya2Vycy5mb3JFYWNoKG1hcmtlciA9PiBtYXJrZXIuc2V0TWFwKG51bGwpKTsKICAgICAgdGhpcy5tYXJrZXJzID0gW107CiAgICB9LAogICAgcmF0ZUxvY2F0aW9uKHZhbHVlKSB7CiAgICAgIHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi51c2VyUmF0aW5nID0gdmFsdWU7CiAgICAgIHJhdGUoewogICAgICAgIGlkOiB0aGlzLnNlbGVjdGVkTG9jYXRpb24uaWQsCiAgICAgICAgc2NvcmU6IHZhbHVlCiAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIuivhOWIhuaIkOWKnyIpOwogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"names":["rate","getlist","name","props","cantindizhi","Object","data","map","markers","isMapLoaded","showCustomInfoWindow","selectedLocation","currentRating","infoWindowPosition","top","left","watch","handler","newVal","console","log","lat","lng","Number","score","animatePanTo","immediate","mounted","initMap","methods","mapContainer","document","getElementById","error","google","maps","Map","center","zoom","addListener","retryLoadMap","setTimeout","location","steps","intervalTime","startLat","getCenter","startLng","deltaLat","deltaLng","currentStep","interval","setInterval","setCenter","clearInterval","setZoom","clearMarkers","addMarker","marker","Marker","position","title","overlay","OverlayView","draw","setMap","markerPosition","getPosition","calculatePosition","projection","getProjection","point","fromLatLngToContainerPixel","userRating","y","x","push","forEach","rateLocation","value","id","then","res","$message","success"],"sources":["src/views/emergencyDispatch/gugeMap.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <!-- 地图容器 -->\r\n    <div id=\"map\" style=\"width: 100%; height: 100vh;\"></div>\r\n\r\n    <!-- 自定义弹窗 -->\r\n    <div v-if=\"showCustomInfoWindow\" class=\"custom-info-window\" :style=\"{\r\n      top: infoWindowPosition.top,\r\n      left: infoWindowPosition.left\r\n    }\">\r\n      <div class=\"info-header\">\r\n        <h3>{{ selectedLocation.name || \"暂无信息\" }}</h3>\r\n        <span class=\"close-btn\" @click=\"showCustomInfoWindow = false\">&times;</span>\r\n      </div>\r\n      <div class=\"info-image\">\r\n        <img\r\n          :src=\"selectedLocation.image || require('@/assets/imgs/image.png')\"\r\n          :alt=\"selectedLocation.name\"\r\n        >\r\n      </div>\r\n      <div class=\"info-content\">\r\n        <div class=\"info-item\">\r\n          <strong>营业时间：</strong>\r\n          <span>{{ selectedLocation.businessHours || \"暂无\" }}</span>\r\n        </div>\r\n        <div class=\"info-item\">\r\n          <strong>当前评分：</strong>\r\n          <el-rate\r\n            v-model=\"selectedLocation.score\"\r\n            disabled\r\n            show-score\r\n            text-color=\"#ff9900\"\r\n            score-template=\"{value}分\"\r\n          />\r\n        </div>\r\n        <div class=\"rating-system\">\r\n          <strong>为餐厅评分：</strong>\r\n          <el-rate\r\n            v-model=\"currentRating\"\r\n            :colors=\"['#99A9BF', '#F7BA2A', '#FF9900']\"\r\n            @change=\"rateLocation\"\r\n            show-text\r\n            :texts=\"['很差', '较差', '一般', '不错', '很好']\"\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { rate,getlist} from '@/api'\r\nexport default {\r\n  name: \"GoogleMap\",\r\n  props: {\r\n    cantindizhi: Object, // 单个对象\r\n  },\r\n  data() {\r\n    return {\r\n      map: null, // 地图实例\r\n      markers: [], // 当前标记数组\r\n      isMapLoaded: false, // 用于标记地图是否加载完成\r\n      showCustomInfoWindow: false, // 控制自定义弹窗显示\r\n      selectedLocation: {}, // 当前选中的位置信息\r\n      currentRating: 0, // 当前评分\r\n      infoWindowPosition: {\r\n        top: '0px',\r\n        left: '0px'\r\n      }\r\n    };\r\n  },\r\n  watch: {\r\n    cantindizhi: {\r\n      handler(newVal) {\r\n        console.log(newVal, \"newVal\");\r\n        if (this.isMapLoaded && newVal && newVal.lat && newVal.lng) {\r\n          newVal.lat = Number(newVal.lat)\r\n          newVal.lng = Number(newVal.lng)\r\n          newVal.score = Number(newVal.score)\r\n          this.animatePanTo(newVal); // 使用动画平移到位置\r\n        }\r\n      },\r\n      immediate: true, // 初始加载时也触发\r\n    },\r\n  },\r\n  mounted() {\r\n    this.initMap();\r\n  },\r\n  methods: {\r\n    initMap() {\r\n      // 确保 DOM 已加载并存在\r\n      const mapContainer = document.getElementById(\"map\");\r\n      if (!mapContainer) {\r\n        console.error(\"地图容器未找到！\");\r\n        return;\r\n      }\r\n\r\n      try {\r\n        // 初始化地图，默认中心点设置为爱尔兰\r\n        this.map = new google.maps.Map(mapContainer, {\r\n          center: { lat: 53.41291, lng: -8.24389 }, // 默认中心坐标\r\n          zoom: 7, // 初始缩放级别\r\n        });\r\n\r\n        this.isMapLoaded = true; // 标记地图加载成功\r\n\r\n        // 如果初始 `cantindizhi` 存在，平移视角到指定位置\r\n        if (this.cantindizhi && this.cantindizhi.lat && this.cantindizhi.lng) {\r\n          this.animatePanTo(this.cantindizhi);\r\n        }\r\n\r\n        // 添加地图移动事件监听，移动时关闭弹窗\r\n        this.map.addListener('dragstart', () => {\r\n          this.showCustomInfoWindow = false;\r\n        });\r\n\r\n        // 添加地图缩放事件监听，缩放时关闭弹窗\r\n        this.map.addListener('zoom_changed', () => {\r\n          this.showCustomInfoWindow = false;\r\n        });\r\n      } catch (error) {\r\n        console.error(\"地图加载失败：\", error);\r\n        this.retryLoadMap(); // 如果加载失败，尝试重新加载\r\n      }\r\n    },\r\n    retryLoadMap() {\r\n      // 重新尝试加载地图\r\n      console.log(\"尝试重新加载地图...\");\r\n      setTimeout(() => {\r\n        this.initMap();\r\n      }, 1000); // 延迟 1 秒重新尝试\r\n    },\r\n    animatePanTo(location) {\r\n      console.log(location, \"locations\");\r\n\r\n      // 使用 setInterval 实现平移动画\r\n      const steps = 30; // 动画的步数\r\n      const intervalTime = 20; // 每步间隔的时间（毫秒）\r\n\r\n      const startLat = this.map.getCenter().lat();\r\n      const startLng = this.map.getCenter().lng();\r\n\r\n      const deltaLat = (location.lat - startLat) / steps;\r\n      const deltaLng = (location.lng - startLng) / steps;\r\n\r\n      let currentStep = 0;\r\n\r\n      const interval = setInterval(() => {\r\n        currentStep++;\r\n        const lat = startLat + deltaLat * currentStep;\r\n        const lng = startLng + deltaLng * currentStep;\r\n\r\n        this.map.setCenter({ lat, lng });\r\n\r\n        if (currentStep >= steps) {\r\n          clearInterval(interval);\r\n          this.map.setCenter({ lat: location.lat, lng: location.lng });\r\n          this.map.setZoom(18); // 放大地图\r\n\r\n          // 更新标记\r\n          this.clearMarkers();\r\n          this.addMarker(location);\r\n        }\r\n      }, intervalTime);\r\n    },\r\n    addMarker(location) {\r\n      const marker = new google.maps.Marker({\r\n        position: { lat: location.lat, lng: location.lng },\r\n        map: this.map,\r\n        title: location.title || \"Location\",\r\n      });\r\n\r\n      // 创建一个全局的 overlay 实例\r\n      const overlay = new google.maps.OverlayView();\r\n      overlay.draw = function() {};\r\n      overlay.setMap(this.map);\r\n\r\n      marker.addListener(\"click\", () => {\r\n        console.log(\"Marker clicked\");\r\n        const markerPosition = marker.getPosition();\r\n\r\n        const calculatePosition = () => {\r\n          console.log(\"Calculating position\");\r\n          const projection = overlay.getProjection();\r\n          const point = projection.fromLatLngToContainerPixel(markerPosition);\r\n\r\n          this.selectedLocation = location;\r\n          this.currentRating = location.userRating || 0;\r\n          this.infoWindowPosition = {\r\n            top: `${point.y}px`,\r\n            left: `${point.x}px`\r\n          };\r\n\r\n          this.showCustomInfoWindow = true;\r\n        };\r\n\r\n        // 如果 projection 已经准备好\r\n        if (overlay.getProjection()) {\r\n          calculatePosition();\r\n        } else {\r\n          // 如果 projection 还没准备好，等待它准备好并立即计算\r\n          overlay.addListener('add', () => {\r\n            setTimeout(calculatePosition, 100); // 添加小延迟确保 projection 完全准备好\r\n          });\r\n        }\r\n      });\r\n\r\n      this.markers.push(marker);\r\n    },\r\n    clearMarkers() {\r\n      // 清除地图上的标记\r\n      this.markers.forEach((marker) => marker.setMap(null));\r\n      this.markers = [];\r\n    },\r\n    rateLocation(value) {\r\n      this.selectedLocation.userRating = value;\r\n      rate({id:this.selectedLocation.id,score:value}).then(res=>{\r\n        this.$message.success(\"评分成功\");\r\n      })\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* 地图样式 */\r\n#map {\r\n  width: 100%;\r\n  height: 100vh;\r\n}\r\n\r\n.custom-info-window {\r\n  position: absolute;\r\n  background: white;\r\n  padding: 20px;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\r\n  z-index: 1000;\r\n  min-width: 350px;\r\n  max-width: 450px;\r\n  transform: translate(-50%, -100%);\r\n}\r\n\r\n.info-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 15px;\r\n  border-bottom: 1px solid #eee;\r\n  padding-bottom: 10px;\r\n}\r\n\r\n.info-header h3 {\r\n  margin: 0;\r\n  color: #333;\r\n}\r\n\r\n.close-btn {\r\n  cursor: pointer;\r\n  font-size: 24px;\r\n  color: #666;\r\n}\r\n\r\n.info-content {\r\n  color: #666;\r\n}\r\n\r\n.info-item {\r\n  margin-bottom: 10px;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n}\r\n\r\n.rating-system {\r\n  margin-top: 15px;\r\n  padding-top: 15px;\r\n  border-top: 1px solid #eee;\r\n}\r\n\r\n.info-image {\r\n  margin: -20px -20px 15px -20px; /* 使图片延伸到边缘 */\r\n  overflow: hidden;\r\n  height: 150px; /* 固定图片容器高度 */\r\n}\r\n\r\n.info-image img {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: cover; /* 确保图片填充整个容器 */\r\n  display: block;\r\n}\r\n\r\n/* 调整 el-rate 的样式 */\r\n:deep(.el-rate) {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n:deep(.el-rate__text) {\r\n  margin-left: 10px;\r\n  font-size: 14px;\r\n  color: #666;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]}]}