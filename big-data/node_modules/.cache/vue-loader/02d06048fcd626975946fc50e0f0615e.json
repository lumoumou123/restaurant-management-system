{"remainingRequest":"C:\\Users\\18167\\Desktop\\final year\\big-data\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\18167\\Desktop\\final year\\big-data\\src\\views\\emergencyDispatch\\gugeMap.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\18167\\Desktop\\final year\\big-data\\src\\views\\emergencyDispatch\\gugeMap.vue","mtime":1742985936383},{"path":"C:\\Users\\18167\\Desktop\\final year\\big-data\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1742859679583},{"path":"C:\\Users\\18167\\Desktop\\final year\\big-data\\node_modules\\babel-loader\\lib\\index.js","mtime":1742859682775},{"path":"C:\\Users\\18167\\Desktop\\final year\\big-data\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1742859679583},{"path":"C:\\Users\\18167\\Desktop\\final year\\big-data\\node_modules\\vue-loader\\lib\\index.js","mtime":1742859683968}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IHJhdGUsIGdldENvbW1lbnRzLCBhZGRDb21tZW50LCBkZWxldGVDb21tZW50IH0gZnJvbSAnQC9hcGknCmltcG9ydCBheGlvcyBmcm9tICdheGlvcycKaW1wb3J0IExvZ2luIGZyb20gJy4uL0xvZ2luLnZ1ZScKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiR29vZ2xlTWFwIiwKICBjb21wb25lbnRzOiB7CiAgICBMb2dpbgogIH0sCiAgcHJvcHM6IHsKICAgIGNhbnRpbmRpemhpOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgIHZhbGlkYXRvcjogKHZhbHVlKSA9PiB7CiAgICAgICAgcmV0dXJuIHZhbHVlICYmIHR5cGVvZiB2YWx1ZS5sYXQgPT09ICdudW1iZXInICYmIHR5cGVvZiB2YWx1ZS5sbmcgPT09ICdudW1iZXInOwogICAgICB9CiAgICB9CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbWFwOiBudWxsLCAvLyDlnLDlm77lrp7kvosKICAgICAgbWFya2VyczogW10sIC8vIOW9k+WJjeagh+iusOaVsOe7hAogICAgICBpc01hcExvYWRlZDogZmFsc2UsIC8vIOeUqOS6juagh+iusOWcsOWbvuaYr+WQpuWKoOi9veWujOaIkAogICAgICBzaG93Q3VzdG9tSW5mb1dpbmRvdzogZmFsc2UsIC8vIOaOp+WItuiHquWumuS5ieW8ueeql+aYvuekugogICAgICBzZWxlY3RlZExvY2F0aW9uOiB7fSwgLy8g5b2T5YmN6YCJ5Lit55qE5L2N572u5L+h5oGvCiAgICAgIGN1cnJlbnRSYXRpbmc6IDAsIC8vIOW9k+WJjeivhOWIhgogICAgICBjb21tZW50czogW10sCiAgICAgIG5ld0NvbW1lbnQ6ICcnLAogICAgICBjdXJyZW50VXNlcklkOiBudWxsLAogICAgICBjdXJyZW50VXNlck5hbWU6IG51bGwsCiAgICAgIG1hcEVycm9yOiBudWxsLAogICAgICBzaG93TG9naW5EaWFsb2c6IGZhbHNlLAogICAgICBtZW51SXRlbXM6IFtdLCAvLyDlrZjlgqjoj5zljZXpobkKICAgICAgYWN0aXZlVGFiOiAnaW5mbycgLy8g5o6n5Yi25b2T5YmN5r+A5rS755qE5qCH562+6aG1CiAgICB9OwogIH0sCiAgd2F0Y2g6IHsKICAgIGNhbnRpbmRpemhpOiB7CiAgICAgIGhhbmRsZXIobmV3VmFsKSB7CiAgICAgICAgY29uc29sZS5sb2cobmV3VmFsLCAibmV3VmFsIik7CiAgICAgICAgaWYgKHRoaXMuaXNNYXBMb2FkZWQgJiYgbmV3VmFsICYmIG5ld1ZhbC5sYXQgJiYgbmV3VmFsLmxuZykgewogICAgICAgICAgbmV3VmFsLmxhdCA9IE51bWJlcihuZXdWYWwubGF0KQogICAgICAgICAgbmV3VmFsLmxuZyA9IE51bWJlcihuZXdWYWwubG5nKQogICAgICAgICAgbmV3VmFsLnNjb3JlID0gTnVtYmVyKG5ld1ZhbC5zY29yZSkKICAgICAgICAgIHRoaXMuYW5pbWF0ZVBhblRvKG5ld1ZhbCk7IC8vIOS9v+eUqOWKqOeUu+W5s+enu+WIsOS9jee9rgogICAgICAgIH0KICAgICAgfSwKICAgICAgaW1tZWRpYXRlOiB0cnVlLCAvLyDliJ3lp4vliqDovb3ml7bkuZ/op6blj5EKICAgIH0sCiAgfSwKICBjcmVhdGVkKCkgewogICAgLy8g5Yid5aeL5YyW5pe25qOA5p+l55m75b2V54q25oCBCiAgICB0aGlzLmNoZWNrTG9naW5TdGF0dXMoKTsKICAgIAogICAgLy8g55uR5ZCsIHN0b3JhZ2Ug5LqL5Lu277yM5b2T5pys5Zyw5a2Y5YKo5Y+Y5YyW5pe25pu05paw55m75b2V54q25oCBCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc3RvcmFnZScsIHRoaXMuY2hlY2tMb2dpblN0YXR1cyk7CiAgICAKICAgIC8vIOebkeWQrOiHquWumuS5ieS6i+S7tgogICAgdGhpcy4kcm9vdC4kb24oJ3VzZXItbG9nZ2VkLWluJywgdGhpcy5oYW5kbGVVc2VyTG9naW4pOwogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuY2hlY2tMb2dpblN0YXR1cygpOwogICAgCiAgICAvLyDmo4Dmn6VHb29nbGUgTWFwcyBBUEnmmK/lkKblt7LliqDovb0KICAgIGlmICh3aW5kb3cuZ29vZ2xlICYmIHdpbmRvdy5nb29nbGUubWFwcykgewogICAgICB0aGlzLmluaXRNYXAoKTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIOWmguaenEdvb2dsZSBNYXBzIEFQSeWwmuacquWKoOi9ve+8jOa3u+WKoOmUmeivr+a2iOaBrwogICAgICB0aGlzLm1hcEVycm9yID0gJ0dvb2dsZSBNYXBzIEFQSSBmYWlsZWQgdG8gbG9hZCc7CiAgICAgIGNvbnNvbGUuZXJyb3IoJ0dvb2dsZSBNYXBzIEFQSSBub3QgbG9hZGVkJyk7CiAgICAgIAogICAgICAvLyDlsJ3or5XpgJrov4fliqjmgIHmt7vliqDohJrmnKzliqDovb0KICAgICAgY29uc3Qgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7CiAgICAgIHNjcmlwdC5zcmMgPSBgaHR0cHM6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL2pzP2tleT0ke3Byb2Nlc3MuZW52LlZVRV9BUFBfR09PR0xFX01BUFNfQVBJX0tFWX0mY2FsbGJhY2s9aW5pdEdvb2dsZU1hcGA7CiAgICAgIHNjcmlwdC5hc3luYyA9IHRydWU7CiAgICAgIHNjcmlwdC5kZWZlciA9IHRydWU7CiAgICAgIAogICAgICAvLyDlhajlsYDlm57osIPlh73mlbAKICAgICAgd2luZG93LmluaXRHb29nbGVNYXAgPSAoKSA9PiB7CiAgICAgICAgdGhpcy5pbml0TWFwKCk7CiAgICAgIH07CiAgICAgIAogICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHNjcmlwdCk7CiAgICB9CiAgfSwKICBiZWZvcmVEZXN0cm95KCkgewogICAgLy8g56e76Zmk5LqL5Lu255uR5ZCsCiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3RvcmFnZScsIHRoaXMuY2hlY2tMb2dpblN0YXR1cyk7CiAgICB0aGlzLiRyb290LiRvZmYoJ3VzZXItbG9nZ2VkLWluJywgdGhpcy5oYW5kbGVVc2VyTG9naW4pOwogIH0sCiAgbWV0aG9kczogewogICAgY2hlY2tMb2dpblN0YXR1cygpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCB1c2VySWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlcklkIik7CiAgICAgICAgY29uc3QgdXNlck5hbWUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlck5hbWUiKTsKICAgICAgICAKICAgICAgICBjb25zb2xlLmxvZygiTWFwIGNvbXBvbmVudCBjaGVja2luZyBsb2NhbFN0b3JhZ2U6IiwgewogICAgICAgICAgdXNlcklkLAogICAgICAgICAgdXNlck5hbWUsCiAgICAgICAgICByYXdWYWx1ZXM6IHsKICAgICAgICAgICAgdXNlcklkOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlcklkIiksCiAgICAgICAgICAgIHVzZXJOYW1lOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlck5hbWUiKQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIAogICAgICAgIGlmICghdXNlcklkIHx8ICF1c2VyTmFtZSkgewogICAgICAgICAgY29uc29sZS5sb2coIlVzZXIgbm90IGxvZ2dlZCBpbiBvciBsb2dpbiBpbmZvcm1hdGlvbiBpbmNvbXBsZXRlIik7CiAgICAgICAgICB0aGlzLmN1cnJlbnRVc2VySWQgPSBudWxsOwogICAgICAgICAgdGhpcy5jdXJyZW50VXNlck5hbWUgPSBudWxsOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5jdXJyZW50VXNlcklkID0gdXNlcklkOwogICAgICAgIHRoaXMuY3VycmVudFVzZXJOYW1lID0gdXNlck5hbWU7CiAgICAgICAgY29uc29sZS5sb2coIlVzZXIgbG9nZ2VkIGluOiIsIHsgCiAgICAgICAgICBjdXJyZW50VXNlcklkOiB0aGlzLmN1cnJlbnRVc2VySWQsIAogICAgICAgICAgY3VycmVudFVzZXJOYW1lOiB0aGlzLmN1cnJlbnRVc2VyTmFtZSAKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCJFcnJvciBjaGVja2luZyBsb2dpbiBzdGF0dXM6IiwgZXJyb3IpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIGluaXRNYXAoKSB7CiAgICAgIGNvbnN0IG1hcENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtYXAiKTsKICAgICAgaWYgKCFtYXBDb250YWluZXIpIHsKICAgICAgICB0aGlzLm1hcEVycm9yID0gJ01hcCBjb250YWluZXIgbm90IGZvdW5kJzsKICAgICAgICBjb25zb2xlLmVycm9yKCJNYXAgY29udGFpbmVyIG5vdCBmb3VuZCEiKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRyeSB7CiAgICAgICAgdGhpcy5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKG1hcENvbnRhaW5lciwgewogICAgICAgICAgY2VudGVyOiB7IGxhdDogNTMuNDEyOTEsIGxuZzogLTguMjQzODkgfSwKICAgICAgICAgIHpvb206IDcsCiAgICAgICAgICBzdHlsZXM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIGZlYXR1cmVUeXBlOiAicG9pIiwKICAgICAgICAgICAgICBlbGVtZW50VHlwZTogImxhYmVscyIsCiAgICAgICAgICAgICAgc3R5bGVyczogW3sgdmlzaWJpbGl0eTogIm9mZiIgfV0KICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0pOwoKICAgICAgICB0aGlzLmlzTWFwTG9hZGVkID0gdHJ1ZTsKCiAgICAgICAgaWYgKHRoaXMuY2FudGluZGl6aGkgJiYgdGhpcy5jYW50aW5kaXpoaS5sYXQgJiYgdGhpcy5jYW50aW5kaXpoaS5sbmcpIHsKICAgICAgICAgIHRoaXMuYW5pbWF0ZVBhblRvKHRoaXMuY2FudGluZGl6aGkpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5tYXAuYWRkTGlzdGVuZXIoJ2RyYWdzdGFydCcsICgpID0+IHsKICAgICAgICAgIHRoaXMuc2hvd0N1c3RvbUluZm9XaW5kb3cgPSBmYWxzZTsKICAgICAgICB9KTsKCiAgICAgICAgdGhpcy5tYXAuYWRkTGlzdGVuZXIoJ3pvb21fY2hhbmdlZCcsICgpID0+IHsKICAgICAgICAgIHRoaXMuc2hvd0N1c3RvbUluZm9XaW5kb3cgPSBmYWxzZTsKICAgICAgICB9KTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICB0aGlzLm1hcEVycm9yID0gJ01hcCBpbml0aWFsaXphdGlvbiBmYWlsZWQ6ICcgKyBlcnJvci5tZXNzYWdlOwogICAgICAgIGNvbnNvbGUuZXJyb3IoJ01hcCBpbml0aWFsaXphdGlvbiBlcnJvcjonLCBlcnJvcik7CiAgICAgIH0KICAgIH0sCiAgICBhbmltYXRlUGFuVG8obG9jYXRpb24pIHsKICAgICAgaWYgKCFsb2NhdGlvbiB8fCAhdGhpcy5tYXApIHJldHVybjsKCiAgICAgIC8vIOa4hemZpOeOsOacieagh+iusAogICAgICB0aGlzLmNsZWFyTWFya2VycygpOwoKICAgICAgLy8g5Yib5bu65paw55qE5qCH6K6wCiAgICAgIGNvbnN0IG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoewogICAgICAgIHBvc2l0aW9uOiB7IGxhdDogbG9jYXRpb24ubGF0LCBsbmc6IGxvY2F0aW9uLmxuZyB9LAogICAgICAgIG1hcDogdGhpcy5tYXAsCiAgICAgICAgdGl0bGU6IGxvY2F0aW9uLm5hbWUgfHwgIkxvY2F0aW9uIgogICAgICB9KTsKCiAgICAgIC8vIOWIm+W7uuS/oeaBr+eql+WPo+eahOimhuebluWxggogICAgICBjb25zdCBvdmVybGF5ID0gbmV3IGdvb2dsZS5tYXBzLk92ZXJsYXlWaWV3KCk7CiAgICAgIG92ZXJsYXkuZHJhdyA9IGZ1bmN0aW9uKCkge307CiAgICAgIG92ZXJsYXkuc2V0TWFwKHRoaXMubWFwKTsKCiAgICAgIC8vIOa3u+WKoOagh+iusOeCueWHu+S6i+S7tgogICAgICBtYXJrZXIuYWRkTGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gewogICAgICAgIGNvbnN0IG1hcmtlclBvc2l0aW9uID0gbWFya2VyLmdldFBvc2l0aW9uKCk7CiAgICAgICAgCiAgICAgICAgLy8g6K6h566X5L+h5oGv56qX5Y+j5L2N572uCiAgICAgICAgY29uc3QgY2FsY3VsYXRlUG9zaXRpb24gPSAoKSA9PiB7CiAgICAgICAgICBjb25zdCBwcm9qZWN0aW9uID0gb3ZlcmxheS5nZXRQcm9qZWN0aW9uKCk7CiAgICAgICAgICBjb25zdCBwb2ludCA9IHByb2plY3Rpb24uZnJvbUxhdExuZ1RvQ29udGFpbmVyUGl4ZWwobWFya2VyUG9zaXRpb24pOwogICAgICAgICAgCiAgICAgICAgICBjb25zb2xlLmxvZygn6YCJ5Lit55qE6aSQ5Y6F5L+h5oGvOicsIGxvY2F0aW9uKTsKICAgICAgICAgIHRoaXMuc2VsZWN0ZWRMb2NhdGlvbiA9IGxvY2F0aW9uOwogICAgICAgICAgdGhpcy5zaG93Q3VzdG9tSW5mb1dpbmRvdyA9IHRydWU7CiAgICAgICAgICB0aGlzLmFjdGl2ZVRhYiA9ICdpbmZvJzsgLy8g6buY6K6k5pi+56S65L+h5oGv5qCH562+6aG1CiAgICAgICAgICB0aGlzLmxvYWRDb21tZW50cygpOyAvLyDliqDovb3or4TorroKICAgICAgICAgIC8vIOmihOWKoOi9veiPnOWNleaVsOaNrgogICAgICAgICAgdGhpcy5sb2FkTWVudSgpOwogICAgICAgIH07CgogICAgICAgIC8vIOehruS/neaKleW9seW3suWHhuWkh+WlvQogICAgICAgIGlmIChvdmVybGF5LmdldFByb2plY3Rpb24oKSkgewogICAgICAgICAgY2FsY3VsYXRlUG9zaXRpb24oKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgb3ZlcmxheS5hZGRMaXN0ZW5lcignYWRkJywgKCkgPT4gewogICAgICAgICAgICBzZXRUaW1lb3V0KGNhbGN1bGF0ZVBvc2l0aW9uLCAxMDApOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIHRoaXMubWFya2Vycy5wdXNoKG1hcmtlcik7CgogICAgICAvLyDlubPmu5Hnp7vliqjliLDmlrDkvY3nva4KICAgICAgdGhpcy5tYXAucGFuVG8oeyBsYXQ6IGxvY2F0aW9uLmxhdCwgbG5nOiBsb2NhdGlvbi5sbmcgfSk7CiAgICAgIHRoaXMubWFwLnNldFpvb20oMTUpOwogICAgfSwKICAgIGNsZWFyTWFya2VycygpIHsKICAgICAgLy8g5riF6Zmk5Zyw5Zu+5LiK55qE5qCH6K6wCiAgICAgIHRoaXMubWFya2Vycy5mb3JFYWNoKChtYXJrZXIpID0+IG1hcmtlci5zZXRNYXAobnVsbCkpOwogICAgICB0aGlzLm1hcmtlcnMgPSBbXTsKICAgIH0sCiAgICByYXRlTG9jYXRpb24odmFsdWUpIHsKICAgICAgaWYgKCF0aGlzLnNlbGVjdGVkTG9jYXRpb24gfHwgIXRoaXMuc2VsZWN0ZWRMb2NhdGlvbi5pZCkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuaXoOazleiOt+WPlumkkOWOheS/oeaBryIpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICAKICAgICAgdGhpcy5zZWxlY3RlZExvY2F0aW9uLnNjb3JlID0gdmFsdWU7CiAgICAgIHJhdGUoe2lkOiB0aGlzLnNlbGVjdGVkTG9jYXRpb24uaWQsIHNjb3JlOiB2YWx1ZX0pCiAgICAgICAgLnRoZW4ocmVzID0+IHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi6K+E5YiG5oiQ5YqfIik7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goZXJyb3IgPT4gewogICAgICAgICAgY29uc29sZS5lcnJvcigi6K+E5YiG5aSx6LSl77yaIiwgZXJyb3IpOwogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi6K+E5YiG5aSx6LSl77yM6K+36YeN6K+VIik7CiAgICAgICAgICB0aGlzLmN1cnJlbnRSYXRpbmcgPSB0aGlzLnNlbGVjdGVkTG9jYXRpb24uc2NvcmUgfHwgMDsgLy8g5oGi5aSN5Y6f6K+E5YiGCiAgICAgICAgfSk7CiAgICB9LAogICAgbG9hZENvbW1lbnRzKCkgewogICAgICBpZiAoIXRoaXMuc2VsZWN0ZWRMb2NhdGlvbiB8fCAhdGhpcy5zZWxlY3RlZExvY2F0aW9uLmlkKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign5peg5rOV5Yqg6L296K+E6K6677ya6aSQ5Y6FSUTkuLrnqbonLCB0aGlzLnNlbGVjdGVkTG9jYXRpb24pOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICAKICAgICAgY29uc29sZS5sb2coJ+ato+WcqOWKoOi9veivhOiuuu+8jOmkkOWOhUlEOicsIHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi5pZCk7CiAgICAgIGdldENvbW1lbnRzKHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi5pZCkKICAgICAgICAudGhlbihyZXMgPT4gewogICAgICAgICAgY29uc29sZS5sb2coJ+ivhOiuuuWKoOi9veWTjeW6lDonLCByZXMpOwogICAgICAgICAgaWYgKHJlcy5jb2RlID09PSAyMDApIHsKICAgICAgICAgICAgdGhpcy5jb21tZW50cyA9IHJlcy5kYXRhOwogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGVycm9yID0+IHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WKoOi9veivhOiuuuWksei0pe+8jOivpue7humUmeivr++8micsIGVycm9yKTsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+WKoOi9veivhOiuuuWksei0pScpOwogICAgICAgIH0pOwogICAgfSwKICAgIGFzeW5jIHN1Ym1pdENvbW1lbnQoKSB7CiAgICAgIGNvbnNvbGUubG9nKCJBdHRlbXB0aW5nIHRvIHN1Ym1pdCBjb21tZW50Iik7CiAgICAgIC8vIOW8uuWItumHjeaWsOajgOafpeeZu+W9leeKtuaAgQogICAgICBjb25zdCBpc0xvZ2dlZEluID0gdGhpcy5jaGVja0xvZ2luU3RhdHVzKCk7CiAgICAgIGNvbnNvbGUubG9nKCJMb2dpbiBzdGF0dXMgY2hlY2sgYmVmb3JlIGNvbW1lbnQ6IiwgeyBpc0xvZ2dlZEluLCB1c2VySWQ6IHRoaXMuY3VycmVudFVzZXJJZCwgdXNlck5hbWU6IHRoaXMuY3VycmVudFVzZXJOYW1lIH0pOwogICAgICAKICAgICAgaWYgKCFpc0xvZ2dlZEluKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCJQbGVhc2UgbG9naW4gYmVmb3JlIGNvbW1lbnRpbmciKTsKICAgICAgICB0aGlzLnNob3dMb2dpbkRpYWxvZyA9IHRydWU7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoIXRoaXMuc2VsZWN0ZWRMb2NhdGlvbiB8fCAhdGhpcy5zZWxlY3RlZExvY2F0aW9uLmlkKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCJQbGVhc2Ugc2VsZWN0IGEgcmVzdGF1cmFudCBmaXJzdCIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBjb21tZW50RGF0YSA9IHsKICAgICAgICAgIHVzZXJJZDogdGhpcy5jdXJyZW50VXNlcklkLAogICAgICAgICAgdXNlck5hbWU6IHRoaXMuY3VycmVudFVzZXJOYW1lLAogICAgICAgICAgY2FudGluZ0lkOiB0aGlzLnNlbGVjdGVkTG9jYXRpb24uaWQsCiAgICAgICAgICBjb250ZW50OiB0aGlzLm5ld0NvbW1lbnQKICAgICAgICB9OwoKICAgICAgICBjb25zb2xlLmxvZygiQ29tbWVudCBkYXRhIHRvIHN1Ym1pdDoiLCBjb21tZW50RGF0YSk7CiAgICAgICAgCiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYWRkQ29tbWVudChjb21tZW50RGF0YSk7CiAgICAgICAgCiAgICAgICAgaWYgKHJlc3VsdC5jb2RlID09PSAyMDApIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcygiQ29tbWVudCBzdWJtaXR0ZWQgc3VjY2Vzc2Z1bGx5ISIpOwogICAgICAgICAgdGhpcy5uZXdDb21tZW50ID0gIiI7CiAgICAgICAgICBhd2FpdCB0aGlzLmxvYWRDb21tZW50cygpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IocmVzdWx0Lm1zZyB8fCAiRmFpbGVkIHRvIHN1Ym1pdCBjb21tZW50Iik7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoIkNvbW1lbnQgc3VibWlzc2lvbiBmYWlsZWQ6IiwgZXJyb3IpOwogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoZXJyb3IubWVzc2FnZSB8fCAiRmFpbGVkIHRvIHN1Ym1pdCBjb21tZW50LCBwbGVhc2UgdHJ5IGFnYWluIGxhdGVyIik7CiAgICAgIH0KICAgIH0sCiAgICBkZWxldGVDb21tZW50KGNvbW1lbnRJZCkgewogICAgICBkZWxldGVDb21tZW50KGNvbW1lbnRJZCkKICAgICAgICAudGhlbihyZXMgPT4gewogICAgICAgICAgaWYgKHJlcy5jb2RlID09PSAyMDApIHsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfliKDpmaTmiJDlip8nKTsKICAgICAgICAgICAgdGhpcy5sb2FkQ29tbWVudHMoKTsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCfliKDpmaTor4TorrrlpLHotKXvvJonLCBlcnJvcik7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfliKDpmaTor4TorrrlpLHotKUnKTsKICAgICAgICB9KTsKICAgIH0sCiAgICBmb3JtYXRUaW1lKHRpbWUpIHsKICAgICAgaWYgKCF0aW1lKSByZXR1cm4gJyc7CiAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSh0aW1lKTsKICAgICAgcmV0dXJuIGAke2RhdGUuZ2V0RnVsbFllYXIoKX0tJHtTdHJpbmcoZGF0ZS5nZXRNb250aCgpICsgMSkucGFkU3RhcnQoMiwgJzAnKX0tJHtTdHJpbmcoZGF0ZS5nZXREYXRlKCkpLnBhZFN0YXJ0KDIsICcwJyl9ICR7U3RyaW5nKGRhdGUuZ2V0SG91cnMoKSkucGFkU3RhcnQoMiwgJzAnKX06JHtTdHJpbmcoZGF0ZS5nZXRNaW51dGVzKCkpLnBhZFN0YXJ0KDIsICcwJyl9YDsKICAgIH0sCiAgICBoYW5kbGVJbWFnZUVycm9yKGUpIHsKICAgICAgZS50YXJnZXQuc3JjID0gcmVxdWlyZSgnQC9hc3NldHMvaW1ncy9pbWFnZS5wbmcnKTsKICAgIH0sCiAgICAvLyDlpITnkIbnmbvlvZXkuovku7YKICAgIGhhbmRsZVVzZXJMb2dpbih1c2VyRGF0YSkgewogICAgICBjb25zb2xlLmxvZygi5Zyw5Zu+57uE5Lu25pS25Yiw55m75b2V5LqL5Lu2OiIsIHVzZXJEYXRhKTsKICAgICAgdGhpcy5jdXJyZW50VXNlcklkID0gdXNlckRhdGEudXNlcklkOwogICAgICB0aGlzLmN1cnJlbnRVc2VyTmFtZSA9IHVzZXJEYXRhLnVzZXJOYW1lOwogICAgICBjb25zb2xlLmxvZygi5pu05paw5ZCO55qE55So5oi354q25oCBOiIsIHsKICAgICAgICBjdXJyZW50VXNlcklkOiB0aGlzLmN1cnJlbnRVc2VySWQsCiAgICAgICAgY3VycmVudFVzZXJOYW1lOiB0aGlzLmN1cnJlbnRVc2VyTmFtZQogICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVMb2dpblN1Y2Nlc3ModXNlckRhdGEpIHsKICAgICAgY29uc29sZS5sb2coIueZu+W9leaIkOWKnzoiLCB1c2VyRGF0YSk7CiAgICAgIHRoaXMuY3VycmVudFVzZXJJZCA9IHVzZXJEYXRhLnVzZXJJZDsKICAgICAgdGhpcy5jdXJyZW50VXNlck5hbWUgPSB1c2VyRGF0YS51c2VyTmFtZTsKICAgICAgY29uc29sZS5sb2coIuabtOaWsOWQjueahOeUqOaIt+eKtuaAgToiLCB7CiAgICAgICAgY3VycmVudFVzZXJJZDogdGhpcy5jdXJyZW50VXNlcklkLAogICAgICAgIGN1cnJlbnRVc2VyTmFtZTogdGhpcy5jdXJyZW50VXNlck5hbWUKICAgICAgfSk7CiAgICB9LAogICAgLy8g5Yqg6L296I+c5Y2VCiAgICBsb2FkTWVudSgpIHsKICAgICAgaWYgKCF0aGlzLnNlbGVjdGVkTG9jYXRpb24gfHwgIXRoaXMuc2VsZWN0ZWRMb2NhdGlvbi5pZCkgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+aXoOazleWKoOi9veiPnOWNle+8mumkkOWOhUlE5Li656m6JywgdGhpcy5zZWxlY3RlZExvY2F0aW9uKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgCiAgICAgIGNvbnNvbGUubG9nKCfmraPlnKjliqDovb3oj5zljZXvvIzppJDljoVJRDonLCB0aGlzLnNlbGVjdGVkTG9jYXRpb24uaWQpOwogICAgICBheGlvcy5nZXQoYGh0dHA6Ly9sb2NhbGhvc3Q6ODA4MC9tZW51L3Jlc3RhdXJhbnQvJHt0aGlzLnNlbGVjdGVkTG9jYXRpb24uaWR9YCkKICAgICAgICAudGhlbihyZXMgPT4gewogICAgICAgICAgY29uc29sZS5sb2coJ+iPnOWNleWKoOi9veWTjeW6lDonLCByZXMuZGF0YSk7CiAgICAgICAgICBpZiAocmVzLmRhdGEuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIHRoaXMubWVudUl0ZW1zID0gcmVzLmRhdGEuZGF0YSB8fCBbXTsKICAgICAgICAgICAgY29uc29sZS5sb2coJ+WKoOi9veeahOiPnOWNlemhuTonLCB0aGlzLm1lbnVJdGVtcyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCfliqDovb3oj5zljZXlpLHotKU6JywgcmVzLmRhdGEubXNnKTsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgbWVudScpOwogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGVycm9yID0+IHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WKoOi9veiPnOWNleWksei0pe+8jOivpue7humUmeivr++8micsIGVycm9yKTsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ0Vycm9yIGxvYWRpbmcgbWVudScpOwogICAgICAgIH0pOwogICAgfSwKICAgIAogICAgLy8g6K6h566X6I+c5Y2V5YiG57G7CiAgICBnZXRJdGVtc0J5Q2F0ZWdvcnkoY2F0ZWdvcnkpIHsKICAgICAgcmV0dXJuIHRoaXMubWVudUl0ZW1zLmZpbHRlcihpdGVtID0+IGl0ZW0uY2F0ZWdvcnkgPT09IGNhdGVnb3J5KTsKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICAvLyDmj5Dlj5bmiYDmnInkuI3ph43lpI3nmoToj5zljZXliIbnsbsKICAgIG1lbnVDYXRlZ29yaWVzKCkgewogICAgICBjb25zdCBjYXRlZ29yaWVzID0gdGhpcy5tZW51SXRlbXMKICAgICAgICAubWFwKGl0ZW0gPT4gaXRlbS5jYXRlZ29yeSkKICAgICAgICAuZmlsdGVyKGNhdGVnb3J5ID0+IGNhdGVnb3J5KTsgLy8g6L+H5ruk5o6J56m65YC8CiAgICAgIAogICAgICAvLyDov5Tlm57ljrvph43lkI7nmoTliIbnsbsKICAgICAgcmV0dXJuIFsuLi5uZXcgU2V0KGNhdGVnb3JpZXMpXTsKICAgIH0KICB9LAp9Owo="},{"version":3,"sources":["gugeMap.vue"],"names":[],"mappings":";AA8JA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"gugeMap.vue","sourceRoot":"src/views/emergencyDispatch","sourcesContent":["<template>\n  <div>\n    <!-- 地图容器 -->\n    <div id=\"map\" style=\"width: 100%; height: 100vh;\"></div>\n    <div v-if=\"mapError\" class=\"map-error\">\n      {{ mapError }}\n    </div>\n\n    <!-- 自定义弹窗 -->\n    <div v-if=\"showCustomInfoWindow\" class=\"custom-info-window\">\n      <div class=\"info-header\">\n        <h3>{{ selectedLocation.name || \"暂无信息\" }}</h3>\n        <span class=\"close-btn\" @click=\"showCustomInfoWindow = false\">&times;</span>\n      </div>\n      <div class=\"info-image\">\n        <img\n          :src=\"selectedLocation.image || require('@/assets/imgs/image.png')\"\n          :alt=\"selectedLocation.name\"\n          @error=\"handleImageError\"\n        >\n      </div>\n      \n      <!-- 标签页导航 -->\n      <div class=\"tab-navigation\">\n        <div \n          class=\"tab-item\" \n          :class=\"{ active: activeTab === 'info' }\"\n          @click=\"activeTab = 'info'\"\n        >\n          Restaurant Info\n        </div>\n        <div \n          class=\"tab-item\" \n          :class=\"{ active: activeTab === 'menu' }\"\n          @click=\"activeTab = 'menu'; loadMenu()\"\n        >\n          Menu\n        </div>\n        <div \n          class=\"tab-item\" \n          :class=\"{ active: activeTab === 'comments' }\"\n          @click=\"activeTab = 'comments'\"\n        >\n          Comments\n        </div>\n      </div>\n      \n      <!-- 餐厅信息标签页 -->\n      <div v-if=\"activeTab === 'info'\" class=\"info-content\">\n        <div class=\"info-item\">\n          <strong>Business Hours:</strong>\n          <span>{{ selectedLocation.businessHours || \"N/A\" }}</span>\n        </div>\n        <div class=\"info-item\">\n          <strong>Current Rating:</strong>\n          <el-rate\n            v-model=\"selectedLocation.score\"\n            disabled\n            show-score\n            text-color=\"#ff9900\"\n            score-template=\"{value} points\"\n          />\n        </div>\n        <div class=\"rating-system\">\n          <strong>Rate this Restaurant:</strong>\n          <el-rate\n            v-model=\"currentRating\"\n            :colors=\"['#99A9BF', '#F7BA2A', '#FF9900']\"\n            @change=\"rateLocation\"\n            show-text\n            :texts=\"['Poor', 'Fair', 'Average', 'Good', 'Excellent']\"\n          />\n        </div>\n      </div>\n      \n      <!-- 菜单标签页 -->\n      <div v-if=\"activeTab === 'menu'\" class=\"menu-content\">\n        <div v-if=\"menuItems.length === 0\" class=\"menu-loading\">\n          <p>Loading menu items...</p>\n        </div>\n        <div v-else-if=\"menuItems.length > 0\" class=\"menu-items\">\n          <div v-for=\"category in menuCategories\" :key=\"category\" class=\"menu-category\">\n            <h4 class=\"category-title\">{{ category }}</h4>\n            <div v-for=\"item in getItemsByCategory(category)\" :key=\"item.id\" class=\"menu-item\">\n              <div class=\"menu-item-header\">\n                <span class=\"menu-item-name\">{{ item.name }}</span>\n                <span class=\"menu-item-price\">€{{ Number(item.price).toFixed(2) }}</span>\n              </div>\n              <p class=\"menu-item-description\">{{ item.description || 'No description available' }}</p>\n              <div v-if=\"item.image\" class=\"menu-item-image\">\n                <img :src=\"item.image\" :alt=\"item.name\" @error=\"handleImageError\">\n              </div>\n              <el-tag \n                size=\"mini\" \n                :type=\"item.isAvailable ? 'success' : 'danger'\"\n                class=\"menu-item-status\"\n              >\n                {{ item.isAvailable ? 'Available' : 'Not Available' }}\n              </el-tag>\n            </div>\n          </div>\n        </div>\n        <div v-else class=\"no-menu\">\n          <p>No menu items available for this restaurant</p>\n        </div>\n      </div>\n      \n      <!-- 评论标签页 -->\n      <div v-if=\"activeTab === 'comments'\" class=\"comments-section\">\n        <h4>Comments</h4>\n        <!-- Add Comment -->\n        <div class=\"add-comment\">\n          <el-input\n            v-model=\"newComment\"\n            type=\"textarea\"\n            :rows=\"2\"\n            placeholder=\"Write your comment...\"\n          />\n          <el-button \n            type=\"primary\" \n            size=\"small\" \n            @click=\"submitComment\"\n            :disabled=\"!newComment.trim()\"\n          >Post Comment</el-button>\n        </div>\n        <!-- Comments List -->\n        <div class=\"comments-list\" v-if=\"comments.length > 0\">\n          <div v-for=\"comment in comments\" :key=\"comment.id\" class=\"comment-item\">\n            <div class=\"comment-header\">\n              <span class=\"username\">{{ comment.userName }}</span>\n              <span class=\"time\">{{ formatTime(comment.createTime) }}</span>\n              <el-button \n                v-if=\"comment.userId === currentUserId\" \n                type=\"text\" \n                size=\"mini\"\n                @click=\"deleteComment(comment.id)\"\n              >Delete</el-button>\n            </div>\n            <div class=\"comment-content\">{{ comment.content }}</div>\n          </div>\n        </div>\n        <div v-else class=\"no-comments\">No comments yet</div>\n      </div>\n    </div>\n\n    <!-- Login Dialog -->\n    <el-dialog\n      title=\"Login\"\n      :visible.sync=\"showLoginDialog\"\n      width=\"400px\"\n      @close=\"showLoginDialog = false\"\n    >\n      <Login @close=\"showLoginDialog = false\" @login-success=\"handleLoginSuccess\" />\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { rate, getComments, addComment, deleteComment } from '@/api'\nimport axios from 'axios'\nimport Login from '../Login.vue'\n\nexport default {\n  name: \"GoogleMap\",\n  components: {\n    Login\n  },\n  props: {\n    cantindizhi: {\n      type: Object,\n      required: true,\n      validator: (value) => {\n        return value && typeof value.lat === 'number' && typeof value.lng === 'number';\n      }\n    }\n  },\n  data() {\n    return {\n      map: null, // 地图实例\n      markers: [], // 当前标记数组\n      isMapLoaded: false, // 用于标记地图是否加载完成\n      showCustomInfoWindow: false, // 控制自定义弹窗显示\n      selectedLocation: {}, // 当前选中的位置信息\n      currentRating: 0, // 当前评分\n      comments: [],\n      newComment: '',\n      currentUserId: null,\n      currentUserName: null,\n      mapError: null,\n      showLoginDialog: false,\n      menuItems: [], // 存储菜单项\n      activeTab: 'info' // 控制当前激活的标签页\n    };\n  },\n  watch: {\n    cantindizhi: {\n      handler(newVal) {\n        console.log(newVal, \"newVal\");\n        if (this.isMapLoaded && newVal && newVal.lat && newVal.lng) {\n          newVal.lat = Number(newVal.lat)\n          newVal.lng = Number(newVal.lng)\n          newVal.score = Number(newVal.score)\n          this.animatePanTo(newVal); // 使用动画平移到位置\n        }\n      },\n      immediate: true, // 初始加载时也触发\n    },\n  },\n  created() {\n    // 初始化时检查登录状态\n    this.checkLoginStatus();\n    \n    // 监听 storage 事件，当本地存储变化时更新登录状态\n    window.addEventListener('storage', this.checkLoginStatus);\n    \n    // 监听自定义事件\n    this.$root.$on('user-logged-in', this.handleUserLogin);\n  },\n  mounted() {\n    this.checkLoginStatus();\n    \n    // 检查Google Maps API是否已加载\n    if (window.google && window.google.maps) {\n      this.initMap();\n    } else {\n      // 如果Google Maps API尚未加载，添加错误消息\n      this.mapError = 'Google Maps API failed to load';\n      console.error('Google Maps API not loaded');\n      \n      // 尝试通过动态添加脚本加载\n      const script = document.createElement('script');\n      script.src = `https://maps.googleapis.com/maps/api/js?key=${process.env.VUE_APP_GOOGLE_MAPS_API_KEY}&callback=initGoogleMap`;\n      script.async = true;\n      script.defer = true;\n      \n      // 全局回调函数\n      window.initGoogleMap = () => {\n        this.initMap();\n      };\n      \n      document.head.appendChild(script);\n    }\n  },\n  beforeDestroy() {\n    // 移除事件监听\n    window.removeEventListener('storage', this.checkLoginStatus);\n    this.$root.$off('user-logged-in', this.handleUserLogin);\n  },\n  methods: {\n    checkLoginStatus() {\n      try {\n        const userId = localStorage.getItem(\"userId\");\n        const userName = localStorage.getItem(\"userName\");\n        \n        console.log(\"Map component checking localStorage:\", {\n          userId,\n          userName,\n          rawValues: {\n            userId: localStorage.getItem(\"userId\"),\n            userName: localStorage.getItem(\"userName\")\n          }\n        });\n        \n        if (!userId || !userName) {\n          console.log(\"User not logged in or login information incomplete\");\n          this.currentUserId = null;\n          this.currentUserName = null;\n          return false;\n        }\n\n        this.currentUserId = userId;\n        this.currentUserName = userName;\n        console.log(\"User logged in:\", { \n          currentUserId: this.currentUserId, \n          currentUserName: this.currentUserName \n        });\n        return true;\n      } catch (error) {\n        console.error(\"Error checking login status:\", error);\n        return false;\n      }\n    },\n    initMap() {\n      const mapContainer = document.getElementById(\"map\");\n      if (!mapContainer) {\n        this.mapError = 'Map container not found';\n        console.error(\"Map container not found!\");\n        return;\n      }\n\n      try {\n        this.map = new google.maps.Map(mapContainer, {\n          center: { lat: 53.41291, lng: -8.24389 },\n          zoom: 7,\n          styles: [\n            {\n              featureType: \"poi\",\n              elementType: \"labels\",\n              stylers: [{ visibility: \"off\" }]\n            }\n          ]\n        });\n\n        this.isMapLoaded = true;\n\n        if (this.cantindizhi && this.cantindizhi.lat && this.cantindizhi.lng) {\n          this.animatePanTo(this.cantindizhi);\n        }\n\n        this.map.addListener('dragstart', () => {\n          this.showCustomInfoWindow = false;\n        });\n\n        this.map.addListener('zoom_changed', () => {\n          this.showCustomInfoWindow = false;\n        });\n      } catch (error) {\n        this.mapError = 'Map initialization failed: ' + error.message;\n        console.error('Map initialization error:', error);\n      }\n    },\n    animatePanTo(location) {\n      if (!location || !this.map) return;\n\n      // 清除现有标记\n      this.clearMarkers();\n\n      // 创建新的标记\n      const marker = new google.maps.Marker({\n        position: { lat: location.lat, lng: location.lng },\n        map: this.map,\n        title: location.name || \"Location\"\n      });\n\n      // 创建信息窗口的覆盖层\n      const overlay = new google.maps.OverlayView();\n      overlay.draw = function() {};\n      overlay.setMap(this.map);\n\n      // 添加标记点击事件\n      marker.addListener(\"click\", () => {\n        const markerPosition = marker.getPosition();\n        \n        // 计算信息窗口位置\n        const calculatePosition = () => {\n          const projection = overlay.getProjection();\n          const point = projection.fromLatLngToContainerPixel(markerPosition);\n          \n          console.log('选中的餐厅信息:', location);\n          this.selectedLocation = location;\n          this.showCustomInfoWindow = true;\n          this.activeTab = 'info'; // 默认显示信息标签页\n          this.loadComments(); // 加载评论\n          // 预加载菜单数据\n          this.loadMenu();\n        };\n\n        // 确保投影已准备好\n        if (overlay.getProjection()) {\n          calculatePosition();\n        } else {\n          overlay.addListener('add', () => {\n            setTimeout(calculatePosition, 100);\n          });\n        }\n      });\n\n      this.markers.push(marker);\n\n      // 平滑移动到新位置\n      this.map.panTo({ lat: location.lat, lng: location.lng });\n      this.map.setZoom(15);\n    },\n    clearMarkers() {\n      // 清除地图上的标记\n      this.markers.forEach((marker) => marker.setMap(null));\n      this.markers = [];\n    },\n    rateLocation(value) {\n      if (!this.selectedLocation || !this.selectedLocation.id) {\n        this.$message.error(\"无法获取餐厅信息\");\n        return;\n      }\n      \n      this.selectedLocation.score = value;\n      rate({id: this.selectedLocation.id, score: value})\n        .then(res => {\n          this.$message.success(\"评分成功\");\n        })\n        .catch(error => {\n          console.error(\"评分失败：\", error);\n          this.$message.error(\"评分失败，请重试\");\n          this.currentRating = this.selectedLocation.score || 0; // 恢复原评分\n        });\n    },\n    loadComments() {\n      if (!this.selectedLocation || !this.selectedLocation.id) {\n        console.error('无法加载评论：餐厅ID为空', this.selectedLocation);\n        return;\n      }\n      \n      console.log('正在加载评论，餐厅ID:', this.selectedLocation.id);\n      getComments(this.selectedLocation.id)\n        .then(res => {\n          console.log('评论加载响应:', res);\n          if (res.code === 200) {\n            this.comments = res.data;\n          }\n        })\n        .catch(error => {\n          console.error('加载评论失败，详细错误：', error);\n          this.$message.error('加载评论失败');\n        });\n    },\n    async submitComment() {\n      console.log(\"Attempting to submit comment\");\n      // 强制重新检查登录状态\n      const isLoggedIn = this.checkLoginStatus();\n      console.log(\"Login status check before comment:\", { isLoggedIn, userId: this.currentUserId, userName: this.currentUserName });\n      \n      if (!isLoggedIn) {\n        this.$message.warning(\"Please login before commenting\");\n        this.showLoginDialog = true;\n        return;\n      }\n\n      if (!this.selectedLocation || !this.selectedLocation.id) {\n        this.$message.warning(\"Please select a restaurant first\");\n        return;\n      }\n\n      try {\n        const commentData = {\n          userId: this.currentUserId,\n          userName: this.currentUserName,\n          cantingId: this.selectedLocation.id,\n          content: this.newComment\n        };\n\n        console.log(\"Comment data to submit:\", commentData);\n        \n        const result = await addComment(commentData);\n        \n        if (result.code === 200) {\n          this.$message.success(\"Comment submitted successfully!\");\n          this.newComment = \"\";\n          await this.loadComments();\n        } else {\n          throw new Error(result.msg || \"Failed to submit comment\");\n        }\n      } catch (error) {\n        console.error(\"Comment submission failed:\", error);\n        this.$message.error(error.message || \"Failed to submit comment, please try again later\");\n      }\n    },\n    deleteComment(commentId) {\n      deleteComment(commentId)\n        .then(res => {\n          if (res.code === 200) {\n            this.$message.success('删除成功');\n            this.loadComments();\n          }\n        })\n        .catch(error => {\n          console.error('删除评论失败：', error);\n          this.$message.error('删除评论失败');\n        });\n    },\n    formatTime(time) {\n      if (!time) return '';\n      const date = new Date(time);\n      return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;\n    },\n    handleImageError(e) {\n      e.target.src = require('@/assets/imgs/image.png');\n    },\n    // 处理登录事件\n    handleUserLogin(userData) {\n      console.log(\"地图组件收到登录事件:\", userData);\n      this.currentUserId = userData.userId;\n      this.currentUserName = userData.userName;\n      console.log(\"更新后的用户状态:\", {\n        currentUserId: this.currentUserId,\n        currentUserName: this.currentUserName\n      });\n    },\n    handleLoginSuccess(userData) {\n      console.log(\"登录成功:\", userData);\n      this.currentUserId = userData.userId;\n      this.currentUserName = userData.userName;\n      console.log(\"更新后的用户状态:\", {\n        currentUserId: this.currentUserId,\n        currentUserName: this.currentUserName\n      });\n    },\n    // 加载菜单\n    loadMenu() {\n      if (!this.selectedLocation || !this.selectedLocation.id) {\n        console.error('无法加载菜单：餐厅ID为空', this.selectedLocation);\n        return;\n      }\n      \n      console.log('正在加载菜单，餐厅ID:', this.selectedLocation.id);\n      axios.get(`http://localhost:8080/menu/restaurant/${this.selectedLocation.id}`)\n        .then(res => {\n          console.log('菜单加载响应:', res.data);\n          if (res.data.code === 200) {\n            this.menuItems = res.data.data || [];\n            console.log('加载的菜单项:', this.menuItems);\n          } else {\n            console.error('加载菜单失败:', res.data.msg);\n            this.$message.error('Failed to load menu');\n          }\n        })\n        .catch(error => {\n          console.error('加载菜单失败，详细错误：', error);\n          this.$message.error('Error loading menu');\n        });\n    },\n    \n    // 计算菜单分类\n    getItemsByCategory(category) {\n      return this.menuItems.filter(item => item.category === category);\n    }\n  },\n  computed: {\n    // 提取所有不重复的菜单分类\n    menuCategories() {\n      const categories = this.menuItems\n        .map(item => item.category)\n        .filter(category => category); // 过滤掉空值\n      \n      // 返回去重后的分类\n      return [...new Set(categories)];\n    }\n  },\n};\n</script>\n\n<style scoped>\n/* 地图样式 */\n#map {\n  width: 100%;\n  height: 100vh;\n}\n\n.custom-info-window {\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  background: white;\n  padding: 20px;\n  border-radius: 12px;\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n  z-index: 1000;\n  width: 400px;\n  max-height: 80vh;\n  overflow-y: auto;\n}\n\n.info-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 15px;\n  border-bottom: 1px solid #eee;\n  padding-bottom: 10px;\n  position: sticky;\n  top: 0;\n  background: white;\n  z-index: 1;\n}\n\n.info-header h3 {\n  margin: 0;\n  color: #333;\n}\n\n.close-btn {\n  cursor: pointer;\n  font-size: 24px;\n  color: #666;\n}\n\n.info-content {\n  display: flex;\n  flex-direction: column;\n  gap: 15px;\n}\n\n.info-item {\n  margin-bottom: 10px;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n\n.rating-system {\n  margin-top: 15px;\n  padding-top: 15px;\n  border-top: 1px solid #eee;\n}\n\n.info-image {\n  margin: -20px -20px 15px -20px;\n  overflow: hidden;\n  height: 150px;\n}\n\n.info-image img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  display: block;\n}\n\n.comments-section {\n  margin-top: 20px;\n  border-top: 1px solid #eee;\n  padding-top: 15px;\n  display: flex;\n  flex-direction: column;\n  gap: 15px;\n}\n\n.comments-section h4 {\n  margin: 0;\n  color: #333;\n  font-size: 16px;\n}\n\n.add-comment {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  margin-bottom: 15px;\n}\n\n.add-comment .el-button {\n  align-self: flex-end;\n  margin: 0;\n}\n\n.comments-list {\n  max-height: 300px;\n  overflow-y: auto;\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n\n.comment-item {\n  background: #f9f9f9;\n  border-radius: 8px;\n  padding: 12px;\n  margin: 0;\n}\n\n.comment-header {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  margin-bottom: 8px;\n}\n\n.username {\n  font-weight: 600;\n  color: #409EFF;\n  font-size: 14px;\n}\n\n.time {\n  font-size: 12px;\n  color: #999;\n  margin-left: auto;\n}\n\n.comment-content {\n  color: #333;\n  line-height: 1.5;\n  font-size: 14px;\n  word-break: break-all;\n  white-space: pre-wrap;\n}\n\n.no-comments {\n  text-align: center;\n  color: #999;\n  padding: 30px 0;\n  background: #f9f9f9;\n  border-radius: 8px;\n}\n\n.map-error {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  background-color: rgba(255, 0, 0, 0.8);\n  color: white;\n  padding: 20px;\n  border-radius: 8px;\n  text-align: center;\n  z-index: 1000;\n}\n\n/* 调整 el-rate 的样式 */\n:deep(.el-rate) {\n  display: flex;\n  align-items: center;\n}\n\n:deep(.el-rate__text) {\n  margin-left: 10px;\n  font-size: 14px;\n  color: #666;\n}\n\n/* 标签页导航 */\n.tab-navigation {\n  display: flex;\n  border-bottom: 1px solid #eee;\n  margin-bottom: 15px;\n}\n\n.tab-item {\n  padding: 10px 15px;\n  cursor: pointer;\n  font-weight: 500;\n  color: #606266;\n  border-bottom: 2px solid transparent;\n  transition: all 0.3s;\n}\n\n.tab-item.active {\n  color: #409EFF;\n  border-bottom-color: #409EFF;\n}\n\n.tab-item:hover {\n  color: #409EFF;\n}\n\n/* 菜单样式 */\n.menu-content {\n  margin-top: 15px;\n}\n\n.menu-loading,\n.no-menu {\n  text-align: center;\n  color: #999;\n  padding: 20px 0;\n}\n\n.menu-category {\n  margin-bottom: 20px;\n}\n\n.category-title {\n  font-size: 18px;\n  color: #333;\n  margin-bottom: 10px;\n  padding-bottom: 5px;\n  border-bottom: 1px solid #eee;\n}\n\n.menu-item {\n  background: #f9f9f9;\n  border-radius: 8px;\n  padding: 12px;\n  margin-bottom: 10px;\n  position: relative;\n}\n\n.menu-item-header {\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 5px;\n}\n\n.menu-item-name {\n  font-weight: 600;\n  font-size: 16px;\n  color: #333;\n}\n\n.menu-item-price {\n  font-weight: 600;\n  color: #67c23a;\n}\n\n.menu-item-description {\n  color: #666;\n  font-size: 14px;\n  margin: 5px 0;\n}\n\n.menu-item-image {\n  margin-top: 10px;\n  height: 100px;\n  overflow: hidden;\n  border-radius: 4px;\n}\n\n.menu-item-image img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.menu-item-status {\n  margin-top: 8px;\n}\n</style>\n"]}]}