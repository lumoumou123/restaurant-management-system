{"remainingRequest":"C:\\Users\\18167\\Desktop\\final year\\big-data\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\18167\\Desktop\\final year\\big-data\\src\\views\\RestaurantStatistics.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\18167\\Desktop\\final year\\big-data\\src\\views\\RestaurantStatistics.vue","mtime":1744734188753},{"path":"C:\\Users\\18167\\Desktop\\final year\\big-data\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1742859679583},{"path":"C:\\Users\\18167\\Desktop\\final year\\big-data\\node_modules\\babel-loader\\lib\\index.js","mtime":1742859682775},{"path":"C:\\Users\\18167\\Desktop\\final year\\big-data\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1742859679583},{"path":"C:\\Users\\18167\\Desktop\\final year\\big-data\\node_modules\\vue-loader\\lib\\index.js","mtime":1742859683968}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBFQ2hhcnRzIGZyb20gJ3Z1ZS1lY2hhcnRzJzsKaW1wb3J0ICdlY2hhcnRzL2xpYi9jaGFydC9iYXInOwppbXBvcnQgJ2VjaGFydHMvbGliL2NoYXJ0L2xpbmUnOwppbXBvcnQgJ2VjaGFydHMvbGliL2NoYXJ0L3BpZSc7CmltcG9ydCAnZWNoYXJ0cy9saWIvY29tcG9uZW50L3Rvb2x0aXAnOwppbXBvcnQgJ2VjaGFydHMvbGliL2NvbXBvbmVudC90aXRsZSc7CmltcG9ydCAnZWNoYXJ0cy9saWIvY29tcG9uZW50L2xlZ2VuZCc7CmltcG9ydCAnZWNoYXJ0cy9saWIvY29tcG9uZW50L2dyaWQnOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgeyBnZXRSZXN0YXVyYW50U3RhdGlzdGljcyB9IGZyb20gJ0AvYXBpL3N0YXRpc3RpY3MnCmltcG9ydCB7IGdldENvbW1lbnRzIH0gZnJvbSAnQC9hcGkvaW5kZXgnCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1Jlc3RhdXJhbnRTdGF0aXN0aWNzJywKICBjb21wb25lbnRzOiB7CiAgICAndi1jaGFydCc6IEVDaGFydHMKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkYXRlUmFuZ2U6IFsKICAgICAgICBuZXcgRGF0ZShuZXcgRGF0ZSgpLnNldERhdGUobmV3IERhdGUoKS5nZXREYXRlKCkgLSA3KSksCiAgICAgICAgbmV3IERhdGUoKQogICAgICBdLAogICAgICBzZWxlY3RlZFJlc3RhdXJhbnQ6IG51bGwsCiAgICAgIHJlc3RhdXJhbnRzOiBbXSwKICAgICAgc3RhdGlzdGljczogewogICAgICAgIGF2ZXJhZ2VSYXRpbmc6IDAsCiAgICAgICAgdG90YWxDb21tZW50czogMCwKICAgICAgICBtZW51SXRlbUNvdW50OiAwLAogICAgICAgIHRvdGFsVmlld3M6IDAsCiAgICAgICAgcmF0aW5nRGlzdHJpYnV0aW9uOiB7fSwKICAgICAgICB2aWV3c1RyZW5kOiBbXSwKICAgICAgICBwb3B1bGFyRGlzaGVzOiBbXSwKICAgICAgICBjb21tZW50c1RpbWVsaW5lOiBbXQogICAgICB9LAogICAgICB1c2VyUm9sZTogJycsCiAgICAgIHVzZXJJZDogbnVsbCwKICAgICAgY29tbWVudHM6IFtdCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIHJhdGluZ0Rpc3RyaWJ1dGlvbkNoYXJ0KCkgewogICAgICBjb25zdCBkYXRhID0gT2JqZWN0LmVudHJpZXModGhpcy5zdGF0aXN0aWNzLnJhdGluZ0Rpc3RyaWJ1dGlvbiB8fCB7fSkubWFwKAogICAgICAgIChbcmF0aW5nLCBjb3VudF0pID0+ICh7CiAgICAgICAgICBuYW1lOiBgJHtyYXRpbmd9IFN0YXJgLAogICAgICAgICAgdmFsdWU6IGNvdW50CiAgICAgICAgfSkKICAgICAgKTsKCiAgICAgIHJldHVybiB7CiAgICAgICAgdG9vbHRpcDogewogICAgICAgICAgdHJpZ2dlcjogJ2l0ZW0nLAogICAgICAgICAgZm9ybWF0dGVyOiAne2J9OiB7Y30gKHtkfSUpJwogICAgICAgIH0sCiAgICAgICAgbGVnZW5kOiB7CiAgICAgICAgICBvcmllbnQ6ICd2ZXJ0aWNhbCcsCiAgICAgICAgICBsZWZ0OiAnbGVmdCcKICAgICAgICB9LAogICAgICAgIHNlcmllczogWwogICAgICAgICAgewogICAgICAgICAgICB0eXBlOiAncGllJywKICAgICAgICAgICAgcmFkaXVzOiBbJzUwJScsICc3MCUnXSwKICAgICAgICAgICAgYXZvaWRMYWJlbE92ZXJsYXA6IGZhbHNlLAogICAgICAgICAgICBsYWJlbDogewogICAgICAgICAgICAgIHNob3c6IHRydWUsCiAgICAgICAgICAgICAgcG9zaXRpb246ICdvdXRzaWRlJwogICAgICAgICAgICB9LAogICAgICAgICAgICBlbXBoYXNpczogewogICAgICAgICAgICAgIGxhYmVsOiB7CiAgICAgICAgICAgICAgICBzaG93OiB0cnVlLAogICAgICAgICAgICAgICAgZm9udFNpemU6ICcxNicsCiAgICAgICAgICAgICAgICBmb250V2VpZ2h0OiAnYm9sZCcKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGxhYmVsTGluZTogewogICAgICAgICAgICAgIHNob3c6IHRydWUKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZGF0YTogZGF0YQogICAgICAgICAgfQogICAgICAgIF0KICAgICAgfTsKICAgIH0sCiAgICB2aWV3c1RyZW5kQ2hhcnQoKSB7CiAgICAgIGNvbnN0IHsgdmlld3NUcmVuZCA9IFtdIH0gPSB0aGlzLnN0YXRpc3RpY3M7CiAgICAgIAogICAgICAvLyDmt7vliqDml6Xlv5fku6Xkvr/osIPor5UKICAgICAgY29uc29sZS5sb2coJ+a4suafk+i2i+WKv+WbvuihqO+8jOaVsOaNruagvOW8jzonLCB0eXBlb2Ygdmlld3NUcmVuZCwgJ+aVsOaNruWGheWuuTonLCB2aWV3c1RyZW5kKTsKICAgICAgCiAgICAgIC8vIOehruS/nXZpZXdzVHJlbmTmmK/mlbDnu4QKICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZpZXdzVHJlbmQpKSB7CiAgICAgICAgY29uc29sZS5lcnJvcigndmlld3NUcmVuZOS4jeaYr+aVsOe7hO+8jOaXoOazlea4suafk+WbvuihqCcsIHZpZXdzVHJlbmQpOwogICAgICAgIHJldHVybiB7CiAgICAgICAgICB0b29sdGlwOiB7CiAgICAgICAgICAgIHRyaWdnZXI6ICdheGlzJwogICAgICAgICAgfSwKICAgICAgICAgIHhBeGlzOiB7CiAgICAgICAgICAgIHR5cGU6ICdjYXRlZ29yeScsCiAgICAgICAgICAgIGRhdGE6IFtdCiAgICAgICAgICB9LAogICAgICAgICAgeUF4aXM6IHsKICAgICAgICAgICAgdHlwZTogJ3ZhbHVlJwogICAgICAgICAgfSwKICAgICAgICAgIHNlcmllczogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgZGF0YTogW10sCiAgICAgICAgICAgICAgdHlwZTogJ2xpbmUnLAogICAgICAgICAgICAgIHNtb290aDogdHJ1ZSwKICAgICAgICAgICAgICBhcmVhU3R5bGU6IHt9CiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9OwogICAgICB9CiAgICAgIAogICAgICAvLyDnoa7kv53mr4/kuKrmlbDmja7ngrnpg73mnIlkYXRl5ZKMdmlld3MKICAgICAgY29uc3QgdmFsaWREYXRhID0gdmlld3NUcmVuZC5maWx0ZXIoaXRlbSA9PiBpdGVtICYmIGl0ZW0uZGF0ZSAmJiBpdGVtLnZpZXdzICE9PSB1bmRlZmluZWQpOwogICAgICBjb25zb2xlLmxvZygn6L+H5ruk5ZCO55qE5pyJ5pWI5pWw5o2u54K5OicsIHZhbGlkRGF0YS5sZW5ndGgpOwogICAgICAKICAgICAgcmV0dXJuIHsKICAgICAgICB0b29sdGlwOiB7CiAgICAgICAgICB0cmlnZ2VyOiAnYXhpcycKICAgICAgICB9LAogICAgICAgIHhBeGlzOiB7CiAgICAgICAgICB0eXBlOiAnY2F0ZWdvcnknLAogICAgICAgICAgZGF0YTogdmFsaWREYXRhLm1hcChpdGVtID0+IGl0ZW0uZGF0ZSkKICAgICAgICB9LAogICAgICAgIHlBeGlzOiB7CiAgICAgICAgICB0eXBlOiAndmFsdWUnCiAgICAgICAgfSwKICAgICAgICBzZXJpZXM6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgZGF0YTogdmFsaWREYXRhLm1hcChpdGVtID0+IGl0ZW0udmlld3MpLAogICAgICAgICAgICB0eXBlOiAnbGluZScsCiAgICAgICAgICAgIHNtb290aDogdHJ1ZSwKICAgICAgICAgICAgYXJlYVN0eWxlOiB7fQogICAgICAgICAgfQogICAgICAgIF0KICAgICAgfTsKICAgIH0sCiAgICBwb3B1bGFyRGlzaGVzQ2hhcnQoKSB7CiAgICAgIGNvbnN0IHsgcG9wdWxhckRpc2hlcyA9IFtdIH0gPSB0aGlzLnN0YXRpc3RpY3M7CiAgICAgIHJldHVybiB7CiAgICAgICAgdG9vbHRpcDogewogICAgICAgICAgdHJpZ2dlcjogJ2F4aXMnLAogICAgICAgICAgYXhpc1BvaW50ZXI6IHsKICAgICAgICAgICAgdHlwZTogJ3NoYWRvdycKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHhBeGlzOiB7CiAgICAgICAgICB0eXBlOiAndmFsdWUnCiAgICAgICAgfSwKICAgICAgICB5QXhpczogewogICAgICAgICAgdHlwZTogJ2NhdGVnb3J5JywKICAgICAgICAgIGRhdGE6IHBvcHVsYXJEaXNoZXMubWFwKGl0ZW0gPT4gaXRlbS5uYW1lKQogICAgICAgIH0sCiAgICAgICAgc2VyaWVzOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIHR5cGU6ICdiYXInLAogICAgICAgICAgICBkYXRhOiBwb3B1bGFyRGlzaGVzLm1hcChpdGVtID0+IGl0ZW0ub3JkZXJDb3VudCkKICAgICAgICAgIH0KICAgICAgICBdCiAgICAgIH07CiAgICB9LAogICAgY29tbWVudHNUaW1lbGluZUNoYXJ0KCkgewogICAgICBjb25zdCB7IGNvbW1lbnRzVGltZWxpbmUgPSBbXSB9ID0gdGhpcy5zdGF0aXN0aWNzOwogICAgICByZXR1cm4gewogICAgICAgIHRvb2x0aXA6IHsKICAgICAgICAgIHRyaWdnZXI6ICdheGlzJwogICAgICAgIH0sCiAgICAgICAgeEF4aXM6IHsKICAgICAgICAgIHR5cGU6ICdjYXRlZ29yeScsCiAgICAgICAgICBkYXRhOiBjb21tZW50c1RpbWVsaW5lLm1hcChpdGVtID0+IGl0ZW0uZGF0ZSkKICAgICAgICB9LAogICAgICAgIHlBeGlzOiB7CiAgICAgICAgICB0eXBlOiAndmFsdWUnCiAgICAgICAgfSwKICAgICAgICBzZXJpZXM6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgZGF0YTogY29tbWVudHNUaW1lbGluZS5tYXAoaXRlbSA9PiBpdGVtLmNvdW50KSwKICAgICAgICAgICAgdHlwZTogJ2xpbmUnLAogICAgICAgICAgICBzbW9vdGg6IHRydWUKICAgICAgICAgIH0KICAgICAgICBdCiAgICAgIH07CiAgICB9LAogICAgY2FsY3VsYXRlVG90YWxSYXRpbmdzKCkgewogICAgICBpZiAoIXRoaXMuc3RhdGlzdGljcy5yYXRpbmdEaXN0cmlidXRpb24pIHJldHVybiAwOwogICAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyh0aGlzLnN0YXRpc3RpY3MucmF0aW5nRGlzdHJpYnV0aW9uKS5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKTsKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICAvLyDojrflj5bnlKjmiLfkv6Hmga8KICAgIHRoaXMudXNlclJvbGUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlclJvbGUnKTsKICAgIHRoaXMudXNlcklkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJJZCcpOwogICAgCiAgICAvLyDorr7nva7pu5jorqTml6XmnJ/ojIPlm7TkuLrmnIDov5E35aSpCiAgICBjb25zdCBlbmQgPSBuZXcgRGF0ZSgpOwogICAgY29uc3Qgc3RhcnQgPSBuZXcgRGF0ZSgpOwogICAgc3RhcnQuc2V0RGF0ZShzdGFydC5nZXREYXRlKCkgLSA3KTsKICAgIHRoaXMuZGF0ZVJhbmdlID0gW3N0YXJ0LCBlbmRdOwogICAgCiAgICAvLyDojrflj5bppJDljoXliJfooagKICAgIHRoaXMuZmV0Y2hSZXN0YXVyYW50cygpOwogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgZmV0Y2hSZXN0YXVyYW50cygpIHsKICAgICAgdHJ5IHsKICAgICAgICAvLyDojrflj5borqTor4Hkv6Hmga8KICAgICAgICBjb25zdCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpOwogICAgICAgIGNvbnN0IGhlYWRlcnMgPSB0b2tlbiA/IHsgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dG9rZW59YCB9IDoge307CiAgICAgICAgCiAgICAgICAgLy8g5re75Yqg55So5oi3SUTlkozop5LoibLliLDor7fmsYLlpLQKICAgICAgICBoZWFkZXJzWydYLVVzZXItSWQnXSA9IHRoaXMudXNlcklkOwogICAgICAgIGhlYWRlcnNbJ1gtVXNlci1Sb2xlJ10gPSB0aGlzLnVzZXJSb2xlOwogICAgICAgIAogICAgICAgIGNvbnNvbGUubG9nKCLliqDovb3ppJDljoXnu5/orqHliJfooag6IOW9k+WJjeeUqOaIt+inkuiJsjoiLCB0aGlzLnVzZXJSb2xlLCAi55So5oi3SUQ6IiwgdGhpcy51c2VySWQpOwogICAgICAgIAogICAgICAgIGxldCByZXNwb25zZTsKICAgICAgICAKICAgICAgICBpZiAodGhpcy51c2VyUm9sZSA9PT0gJ01hbmFnZXInKSB7CiAgICAgICAgICAvLyDnrqHnkIblkZjlj6/ku6XnnIvliLDmiYDmnInppJDljoUKICAgICAgICAgIHJlc3BvbnNlID0gYXdhaXQgYXhpb3MuZ2V0KCdodHRwOi8vbG9jYWxob3N0OjgwODAvYXBpL2NhbnRlZW4vbGlzdCcsIHsgaGVhZGVycyB9KTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMudXNlclJvbGUgPT09ICdPd25lcicpIHsKICAgICAgICAgIC8vIOS4muS4u+WPquiDveeci+WIsOiHquW3seeahOmkkOWOhQogICAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5nZXQoYGh0dHA6Ly9sb2NhbGhvc3Q6ODA4MC9hcGkvY2FudGVlbi9vd25lci9jYW50ZWVuc2AsIHsgaGVhZGVycyB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfmgqjnmoTnlKjmiLfop5LoibLkuI3lhYHorrjorr/pl67ppJDljoXnu5/orqHkv6Hmga8nKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5kYXRhICYmIHJlc3BvbnNlLmRhdGEuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICB0aGlzLnJlc3RhdXJhbnRzID0gcmVzcG9uc2UuZGF0YS5kYXRhIHx8IFtdOwogICAgICAgICAgY29uc29sZS5sb2coYOaIkOWKn+WKoOi9vSR7dGhpcy5yZXN0YXVyYW50cy5sZW5ndGh95a626aSQ5Y6F55So5LqO57uf6K6hYCk7CiAgICAgICAgICAKICAgICAgICAgIGlmICh0aGlzLnJlc3RhdXJhbnRzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJlc3RhdXJhbnQgPSB0aGlzLnJlc3RhdXJhbnRzWzBdLmlkOwogICAgICAgICAgICB0aGlzLmZldGNoU3RhdGlzdGljcygpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfmnKrmib7liLDku7vkvZXppJDljoUnKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5Yqg6L296aSQ5Y6F5YiX6KGo5aSx6LSlOiAnICsgKHJlc3BvbnNlPy5kYXRhPy5tc2cgfHwgJ+acquefpemUmeivrycpKTsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIuWKoOi9vemkkOWOheWksei0pToiLCByZXNwb25zZT8uZGF0YSk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBmZXRjaCByZXN0YXVyYW50czonLCBlcnJvcik7CiAgICAgICAgY29uc29sZS5lcnJvcigi6K+35rGC5aSx6LSl6K+m5oOFOiIsIGVycm9yLnJlc3BvbnNlID8gZXJyb3IucmVzcG9uc2UuZGF0YSA6IGVycm9yLm1lc3NhZ2UpOwogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIHJlc3RhdXJhbnRzOiAnICsgKGVycm9yLnJlc3BvbnNlPy5kYXRhPy5tc2cgfHwgZXJyb3IubWVzc2FnZSkpOwogICAgICB9CiAgICB9LAogICAgYXN5bmMgZmV0Y2hTdGF0aXN0aWNzKCkgewogICAgICBpZiAoIXRoaXMuc2VsZWN0ZWRSZXN0YXVyYW50IHx8ICF0aGlzLmRhdGVSYW5nZSkgewogICAgICAgIHRoaXMuJG1lc3NhZ2Uud2FybmluZygnUGxlYXNlIHNlbGVjdCBib3RoIHJlc3RhdXJhbnQgYW5kIGRhdGUgcmFuZ2UnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IFtzdGFydERhdGUsIGVuZERhdGVdID0gdGhpcy5kYXRlUmFuZ2U7CiAgICAgIGNvbnNvbGUubG9nKCdGZXRjaGluZyBzdGF0aXN0aWNzIGZvcjonLCB7CiAgICAgICAgcmVzdGF1cmFudElkOiB0aGlzLnNlbGVjdGVkUmVzdGF1cmFudCwKICAgICAgICBzdGFydERhdGU6IHN0YXJ0RGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF0sCiAgICAgICAgZW5kRGF0ZTogZW5kRGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF0KICAgICAgfSk7CgogICAgICB0cnkgewogICAgICAgIC8vIOiOt+WPluiupOivgeS/oeaBrwogICAgICAgIGNvbnN0IHRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJyk7CiAgICAgICAgY29uc3QgaGVhZGVycyA9IHRva2VuID8geyAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0b2tlbn1gIH0gOiB7fTsKICAgICAgICAKICAgICAgICAvLyDmt7vliqDnlKjmiLdJROWSjOinkuiJsuWIsOivt+axguWktAogICAgICAgIGhlYWRlcnNbJ1gtVXNlci1JZCddID0gdGhpcy51c2VySWQ7CiAgICAgICAgaGVhZGVyc1snWC1Vc2VyLVJvbGUnXSA9IHRoaXMudXNlclJvbGU7CiAgICAgICAgCiAgICAgICAgY29uc29sZS5sb2coYOato+WcqOiOt+WPlumkkOWOhUlEPSR7dGhpcy5zZWxlY3RlZFJlc3RhdXJhbnR955qE57uf6K6h5pWw5o2uYCk7CiAgICAgICAgCiAgICAgICAgLy8g5qC55o2u5ZCO56uvU3RhdGlzdGljc0NvbnRyb2xsZXLnmoTot6/lvoTosIPmlbRVUkwKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGF4aW9zKHsKICAgICAgICAgIG1ldGhvZDogJ2dldCcsCiAgICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjgwODAvc3RhdGlzdGljcy9jYW50aW5nJywKICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICBjYW50ZWVuSWQ6IHRoaXMuc2VsZWN0ZWRSZXN0YXVyYW50LAogICAgICAgICAgICBzdGFydERhdGU6IHN0YXJ0RGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF0sCiAgICAgICAgICAgIGVuZERhdGU6IGVuZERhdGUudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdCiAgICAgICAgICB9LAogICAgICAgICAgaGVhZGVycwogICAgICAgIH0pOwoKICAgICAgICBjb25zb2xlLmxvZygnUmF3IEFQSSByZXNwb25zZTonLCByZXNwb25zZS5kYXRhKTsKCiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEgJiYgcmVzcG9uc2UuZGF0YS5jb2RlID09PSAyMDApIHsKICAgICAgICAgIHRoaXMuc3RhdGlzdGljcyA9IHJlc3BvbnNlLmRhdGEuZGF0YSB8fCB7fTsKICAgICAgICAgIC8vIEVuc3VyZSBhdmVyYWdlUmF0aW5nIGlzIGEgbnVtYmVyCiAgICAgICAgICB0aGlzLnN0YXRpc3RpY3MuYXZlcmFnZVJhdGluZyA9IE51bWJlcih0aGlzLnN0YXRpc3RpY3MuYXZlcmFnZVJhdGluZyB8fCAwKTsKICAgICAgICAgIAogICAgICAgICAgLy8g56Gu5L+d5omA5pyJ5b+F6KaB55qE57uf6K6h5a2X5q616YO95a2Y5Zyo77yM6YG/5YWN56m65oyH6ZKICiAgICAgICAgICB0aGlzLmVuc3VyZVN0YXRpc3RpY3NTdHJ1Y3R1cmUoKTsKICAgICAgICAgIAogICAgICAgICAgY29uc29sZS5sb2coJ1Byb2Nlc3NlZCBzdGF0aXN0aWNzOicsIHRoaXMuc3RhdGlzdGljcyk7CiAgICAgICAgICAKICAgICAgICAgIC8vIOWKoOi9veivhOiuugogICAgICAgICAgdGhpcy5sb2FkQ29tbWVudHMoKTsKICAgICAgICAgIAogICAgICAgICAgLy8g5Yqg6L296I+c5Y2V6aG5CiAgICAgICAgICB0aGlzLmxvYWRNZW51SXRlbXMoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5lcnJvcignQVBJIGVycm9yOicsIHJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXNwb25zZS5kYXRhPy5tc2cgfHwgJ0ZhaWxlZCB0byBsb2FkIHN0YXRpc3RpY3MnKTsKICAgICAgICAgIAogICAgICAgICAgLy8g5aaC5p6c6I635Y+W5aSx6LSl77yM5Yid5aeL5YyW56m65pWw5o2uCiAgICAgICAgICB0aGlzLnJlc2V0U3RhdGlzdGljcygpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZmV0Y2ggc3RhdGlzdGljczonLCBlcnJvcik7CiAgICAgICAgY29uc29sZS5lcnJvcigi6K+35rGC5aSx6LSl6K+m5oOFOiIsIGVycm9yLnJlc3BvbnNlID8gZXJyb3IucmVzcG9uc2UuZGF0YSA6IGVycm9yLm1lc3NhZ2UpOwogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIHN0YXRpc3RpY3M6ICcgKyAoZXJyb3IucmVzcG9uc2U/LmRhdGE/Lm1zZyB8fCBlcnJvci5tZXNzYWdlKSk7CiAgICAgICAgCiAgICAgICAgLy8g5aaC5p6c6ZSZ6K+v77yM5Yid5aeL5YyW56m65pWw5o2uCiAgICAgICAgdGhpcy5yZXNldFN0YXRpc3RpY3MoKTsKICAgICAgfQogICAgfSwKICAgIGxvYWRNb2NrRGF0YSgpIHsKICAgICAgdGhpcy5zdGF0aXN0aWNzID0gewogICAgICAgIGF2ZXJhZ2VSYXRpbmc6IDQuNCwKICAgICAgICB0b3RhbENvbW1lbnRzOiAxNSwKICAgICAgICBtZW51SXRlbUNvdW50OiAyNCwKICAgICAgICB0b3RhbFZpZXdzOiA0MDc5LAogICAgICAgIHJhdGluZ0Rpc3RyaWJ1dGlvbjogewogICAgICAgICAgJzEgU3Rhcic6IDUsCiAgICAgICAgICAnMiBTdGFycyc6IDEwLAogICAgICAgICAgJzMgU3RhcnMnOiAyMCwKICAgICAgICAgICc0IFN0YXJzJzogNDAsCiAgICAgICAgICAnNSBTdGFycyc6IDI1CiAgICAgICAgfSwKICAgICAgICB2aWV3c1RyZW5kOiBBcnJheS5mcm9tKHsgbGVuZ3RoOiA3IH0sIChfLCBpKSA9PiAoewogICAgICAgICAgZGF0ZTogbmV3IERhdGUoRGF0ZS5ub3coKSAtICg2IC0gaSkgKiAyNCAqIDYwICogNjAgKiAxMDAwKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF0sCiAgICAgICAgICB2aWV3czogTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKSArIDUwCiAgICAgICAgfSkpLAogICAgICAgIHBvcHVsYXJEaXNoZXM6IFsKICAgICAgICAgIHsgbmFtZTogJ0Rpc2ggMScsIG9yZGVyQ291bnQ6IDQ1IH0sCiAgICAgICAgICB7IG5hbWU6ICdEaXNoIDInLCBvcmRlckNvdW50OiAzOCB9LAogICAgICAgICAgeyBuYW1lOiAnRGlzaCAzJywgb3JkZXJDb3VudDogMzIgfSwKICAgICAgICAgIHsgbmFtZTogJ0Rpc2ggNCcsIG9yZGVyQ291bnQ6IDI1IH0sCiAgICAgICAgICB7IG5hbWU6ICdEaXNoIDUnLCBvcmRlckNvdW50OiAyMCB9CiAgICAgICAgXSwKICAgICAgICBjb21tZW50c1RpbWVsaW5lOiBBcnJheS5mcm9tKHsgbGVuZ3RoOiA3IH0sIChfLCBpKSA9PiAoewogICAgICAgICAgZGF0ZTogbmV3IERhdGUoRGF0ZS5ub3coKSAtICg2IC0gaSkgKiAyNCAqIDYwICogNjAgKiAxMDAwKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF0sCiAgICAgICAgICBjb3VudDogTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApCiAgICAgICAgfSkpCiAgICAgIH07CiAgICAgIAogICAgICAvLyDnlJ/miJDmqKHmi5/or4TorrrmlbDmja4KICAgICAgdGhpcy5jb21tZW50cyA9IFsKICAgICAgICB7CiAgICAgICAgICBpZDogMSwKICAgICAgICAgIHVzZXJOYW1lOiAnSm9obiBEb2UnLAogICAgICAgICAgY29udGVudDogJ0dyZWF0IGZvb2QgYW5kIGV4Y2VsbGVudCBzZXJ2aWNlISBXaWxsIGRlZmluaXRlbHkgY29tZSBiYWNrIGFnYWluLicsCiAgICAgICAgICBzY29yZTogNSwKICAgICAgICAgIGNyZWF0ZVRpbWU6IG5ldyBEYXRlKERhdGUubm93KCkgLSAyICogMjQgKiA2MCAqIDYwICogMTAwMCkudG9JU09TdHJpbmcoKQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaWQ6IDIsCiAgICAgICAgICB1c2VyTmFtZTogJ0FsaWNlIFNtaXRoJywKICAgICAgICAgIGNvbnRlbnQ6ICdGb29kIHdhcyBnb29kIGJ1dCB0aGUgd2FpdCB0aW1lIHdhcyBhIGJpdCBsb25nLicsCiAgICAgICAgICBzY29yZTogNCwgCiAgICAgICAgICBjcmVhdGVUaW1lOiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gMyAqIDI0ICogNjAgKiA2MCAqIDEwMDApLnRvSVNPU3RyaW5nKCkKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGlkOiAzLAogICAgICAgICAgdXNlck5hbWU6ICdCb2IgSm9obnNvbicsCiAgICAgICAgICBjb250ZW50OiAnQXZlcmFnZSBleHBlcmllbmNlLiBOb3RoaW5nIHNwZWNpYWwuJywKICAgICAgICAgIHNjb3JlOiAzLAogICAgICAgICAgY3JlYXRlVGltZTogbmV3IERhdGUoRGF0ZS5ub3coKSAtIDUgKiAyNCAqIDYwICogNjAgKiAxMDAwKS50b0lTT1N0cmluZygpCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpZDogNCwKICAgICAgICAgIHVzZXJOYW1lOiAnRW1tYSBXaWxzb24nLAogICAgICAgICAgY29udGVudDogJ0Rpc2FwcG9pbnRlZCB3aXRoIHRoZSBxdWFsaXR5IG9mIGZvb2QuIE5vdCB3b3J0aCB0aGUgcHJpY2UuJywKICAgICAgICAgIHNjb3JlOiAyLAogICAgICAgICAgY3JlYXRlVGltZTogbmV3IERhdGUoRGF0ZS5ub3coKSAtIDYgKiAyNCAqIDYwICogNjAgKiAxMDAwKS50b0lTT1N0cmluZygpCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpZDogNSwKICAgICAgICAgIHVzZXJOYW1lOiAnTWljaGFlbCBCcm93bicsCiAgICAgICAgICBjb250ZW50OiAnVGVycmlibGUgZXhwZXJpZW5jZSEgRm9vZCB3YXMgY29sZCBhbmQgc2VydmljZSB3YXMgcnVkZS4nLAogICAgICAgICAgc2NvcmU6IDEsCiAgICAgICAgICBjcmVhdGVUaW1lOiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gNyAqIDI0ICogNjAgKiA2MCAqIDEwMDApLnRvSVNPU3RyaW5nKCkKICAgICAgICB9CiAgICAgIF07CiAgICB9LAogICAgYXN5bmMgdGVzdEFQSSgpIHsKICAgICAgdHJ5IHsKICAgICAgICAvLyDojrflj5borqTor4Hkv6Hmga8KICAgICAgICBjb25zdCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpOwogICAgICAgIGNvbnN0IGhlYWRlcnMgPSB0b2tlbiA/IHsgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dG9rZW59YCB9IDoge307CiAgICAgICAgCiAgICAgICAgLy8g5re75Yqg55So5oi3SUTlkozop5LoibLliLDor7fmsYLlpLQKICAgICAgICBoZWFkZXJzWydYLVVzZXItSWQnXSA9IHRoaXMudXNlcklkOwogICAgICAgIGhlYWRlcnNbJ1gtVXNlci1Sb2xlJ10gPSB0aGlzLnVzZXJSb2xlOwogICAgICAgIAogICAgICAgIGNvbnNvbGUubG9nKCdUZXN0aW5nIHN0YXRpc3RpY3MgQVBJLi4uJyk7CiAgICAgICAgCiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5nZXQoJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MC9hcGkvc3RhdGlzdGljcy90ZXN0JywgeyBoZWFkZXJzIH0pOwogICAgICAgIAogICAgICAgIGlmIChyZXNwb25zZS5kYXRhICYmIHJlc3BvbnNlLmRhdGEuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ0FQSSB0ZXN0IHN1Y2Nlc3NmdWwnKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCdBUEnmtYvor5Xlk43lupQ6JywgcmVzcG9uc2UuZGF0YSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uud2FybmluZygnQVBJIHRlc3QgcmV0dXJuZWQgdW5leHBlY3RlZCByZXNwb25zZScpOwogICAgICAgICAgY29uc29sZS53YXJuKCdBUEnmtYvor5XmhI/lpJblk43lupQ6JywgcmVzcG9uc2UuZGF0YSk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0FQSSB0ZXN0IGZhaWxlZDonLCBlcnJvcik7CiAgICAgICAgY29uc29sZS5lcnJvcigi6K+35rGC5aSx6LSl6K+m5oOFOiIsIGVycm9yLnJlc3BvbnNlID8gZXJyb3IucmVzcG9uc2UuZGF0YSA6IGVycm9yLm1lc3NhZ2UpOwogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ0FQSSB0ZXN0IGZhaWxlZDogJyArIChlcnJvci5yZXNwb25zZT8uZGF0YT8ubXNnIHx8IGVycm9yLm1lc3NhZ2UpKTsKICAgICAgfQogICAgfSwKICAgIGxvZ1Jlc3RhdXJhbnREZXRhaWxzKCkgewogICAgICBjb25zb2xlLmxvZygnQ3VycmVudCBTdGF0aXN0aWNzOicsIHRoaXMuc3RhdGlzdGljcyk7CiAgICAgIGNvbnNvbGUubG9nKCdTZWxlY3RlZCBSZXN0YXVyYW50OicsIHRoaXMuc2VsZWN0ZWRSZXN0YXVyYW50KTsKICAgICAgY29uc29sZS5sb2coJ0RhdGUgUmFuZ2U6JywgdGhpcy5kYXRlUmFuZ2UpOwogICAgfSwKICAgIGJhY2tUb0hvbWUoKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvJyk7CiAgICB9LAogICAgLy8g6YeN572u57uf6K6h5pWw5o2u5Li66buY6K6k56m65YC8CiAgICByZXNldFN0YXRpc3RpY3MoKSB7CiAgICAgIHRoaXMuc3RhdGlzdGljcyA9IHsKICAgICAgICBhdmVyYWdlUmF0aW5nOiAwLAogICAgICAgIHRvdGFsQ29tbWVudHM6IDAsCiAgICAgICAgbWVudUl0ZW1Db3VudDogMCwKICAgICAgICB0b3RhbFZpZXdzOiAwLAogICAgICAgIHJhdGluZ0Rpc3RyaWJ1dGlvbjoge30sCiAgICAgICAgdmlld3NUcmVuZDogW10sCiAgICAgICAgcG9wdWxhckRpc2hlczogW10sCiAgICAgICAgY29tbWVudHNUaW1lbGluZTogW10KICAgICAgfTsKICAgIH0sCiAgICAvLyDnoa7kv53miYDmnInlv4XopoHnmoTnu5/orqHlrZfmrrXpg73lrZjlnKgKICAgIGVuc3VyZVN0YXRpc3RpY3NTdHJ1Y3R1cmUoKSB7CiAgICAgIGlmICghdGhpcy5zdGF0aXN0aWNzKSB0aGlzLnN0YXRpc3RpY3MgPSB7fTsKICAgICAgCiAgICAgIHRoaXMuc3RhdGlzdGljcy5hdmVyYWdlUmF0aW5nID0gTnVtYmVyKHRoaXMuc3RhdGlzdGljcy5hdmVyYWdlUmF0aW5nIHx8IDApOwogICAgICB0aGlzLnN0YXRpc3RpY3MudG90YWxDb21tZW50cyA9IHRoaXMuc3RhdGlzdGljcy50b3RhbENvbW1lbnRzIHx8IDA7CiAgICAgIHRoaXMuc3RhdGlzdGljcy5tZW51SXRlbUNvdW50ID0gdGhpcy5zdGF0aXN0aWNzLm1lbnVJdGVtQ291bnQgfHwgMDsKICAgICAgdGhpcy5zdGF0aXN0aWNzLnRvdGFsVmlld3MgPSB0aGlzLnN0YXRpc3RpY3MudG90YWxWaWV3cyB8fCAwOwogICAgICAKICAgICAgLy8g5aSE55CG6K+E5YiG5YiG5biD5pWw5o2uCiAgICAgIGlmICh0aGlzLnN0YXRpc3RpY3MucmF0aW5nRGlzdHJpYnV0aW9uICYmIHR5cGVvZiB0aGlzLnN0YXRpc3RpY3MucmF0aW5nRGlzdHJpYnV0aW9uID09PSAnb2JqZWN0JykgewogICAgICAgIGNvbnNvbGUubG9nKCflpITnkIbor4TliIbliIbluIPmlbDmja46JywgdGhpcy5zdGF0aXN0aWNzLnJhdGluZ0Rpc3RyaWJ1dGlvbik7CiAgICAgICAgCiAgICAgICAgLy8g56Gu5L+d6K+E5YiG5YiG5biD55qE6ZSu5piv5a2X56ym5Liy5qC85byP5aaCICIxIFN0YXIiLCAiMiBTdGFycyIg562JCiAgICAgICAgY29uc3QgZm9ybWF0dGVkRGlzdHJpYnV0aW9uID0ge307CiAgICAgICAgT2JqZWN0LmVudHJpZXModGhpcy5zdGF0aXN0aWNzLnJhdGluZ0Rpc3RyaWJ1dGlvbikuZm9yRWFjaCgoW3JhdGluZywgY291bnRdKSA9PiB7CiAgICAgICAgICBjb25zdCBzdGFycyA9IE51bWJlcihyYXRpbmcpOwogICAgICAgICAgaWYgKCFpc05hTihzdGFycykpIHsKICAgICAgICAgICAgZm9ybWF0dGVkRGlzdHJpYnV0aW9uW2Ake3N0YXJzfSBTdGFyJHtzdGFycyA+IDEgPyAncycgOiAnJ31gXSA9IGNvdW50OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZm9ybWF0dGVkRGlzdHJpYnV0aW9uW3JhdGluZ10gPSBjb3VudDsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICAKICAgICAgICB0aGlzLnN0YXRpc3RpY3MucmF0aW5nRGlzdHJpYnV0aW9uID0gZm9ybWF0dGVkRGlzdHJpYnV0aW9uOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc3RhdGlzdGljcy5yYXRpbmdEaXN0cmlidXRpb24gPSB7fTsKICAgICAgfQogICAgICAKICAgICAgLy8g5aSE55CGdmlld3NUcmVuZO+8muWwhuWvueixoeagvOW8j+i9rOaNouS4uuaVsOe7hOagvOW8jwogICAgICBpZiAodGhpcy5zdGF0aXN0aWNzLnZpZXdzVHJlbmQgJiYgdHlwZW9mIHRoaXMuc3RhdGlzdGljcy52aWV3c1RyZW5kID09PSAnb2JqZWN0JyAmJiAhQXJyYXkuaXNBcnJheSh0aGlzLnN0YXRpc3RpY3Mudmlld3NUcmVuZCkpIHsKICAgICAgICAvLyDlpoLmnpx2aWV3c1RyZW5k5piv5a+56LGh5qC85byPKOWQjuerr+i/lOWbnueahOagvOW8jynvvIzovazmjaLkuLrmlbDnu4TmoLzlvI8KICAgICAgICBjb25zb2xlLmxvZygn6L2s5o2idmlld3NUcmVuZOagvOW8j++8jOS7juWvueixoeWIsOaVsOe7hDonLCB0aGlzLnN0YXRpc3RpY3Mudmlld3NUcmVuZCk7CiAgICAgICAgCiAgICAgICAgY29uc3QgdHJlbmRBcnJheSA9IE9iamVjdC5lbnRyaWVzKHRoaXMuc3RhdGlzdGljcy52aWV3c1RyZW5kKS5tYXAoKFtkYXRlLCB2aWV3c10pID0+ICh7CiAgICAgICAgICBkYXRlLAogICAgICAgICAgdmlld3M6IE51bWJlcih2aWV3cykKICAgICAgICB9KSk7CiAgICAgICAgCiAgICAgICAgLy8g5oyJ5pel5pyf5o6S5bqPCiAgICAgICAgdHJlbmRBcnJheS5zb3J0KChhLCBiKSA9PiBuZXcgRGF0ZShhLmRhdGUpIC0gbmV3IERhdGUoYi5kYXRlKSk7CiAgICAgICAgdGhpcy5zdGF0aXN0aWNzLnZpZXdzVHJlbmQgPSB0cmVuZEFycmF5OwogICAgICAgIAogICAgICAgIGNvbnNvbGUubG9nKCfovazmjaLlkI7nmoR2aWV3c1RyZW5kOicsIHRoaXMuc3RhdGlzdGljcy52aWV3c1RyZW5kKTsKICAgICAgfSBlbHNlIGlmICghdGhpcy5zdGF0aXN0aWNzLnZpZXdzVHJlbmQpIHsKICAgICAgICB0aGlzLnN0YXRpc3RpY3Mudmlld3NUcmVuZCA9IFtdOwogICAgICB9CiAgICAgIAogICAgICAvLyDnoa7kv51wb3B1bGFyRGlzaGVz5piv5pWw57uECiAgICAgIGlmICghQXJyYXkuaXNBcnJheSh0aGlzLnN0YXRpc3RpY3MucG9wdWxhckRpc2hlcykpIHsKICAgICAgICB0aGlzLnN0YXRpc3RpY3MucG9wdWxhckRpc2hlcyA9IFtdOwogICAgICB9CiAgICAgIAogICAgICAvLyDnoa7kv51jb21tZW50c1RpbWVsaW5l5piv5pWw57uECiAgICAgIGlmICh0aGlzLnN0YXRpc3RpY3MuY29tbWVudHNUaW1lbGluZSAmJiB0eXBlb2YgdGhpcy5zdGF0aXN0aWNzLmNvbW1lbnRzVGltZWxpbmUgPT09ICdvYmplY3QnICYmICFBcnJheS5pc0FycmF5KHRoaXMuc3RhdGlzdGljcy5jb21tZW50c1RpbWVsaW5lKSkgewogICAgICAgIC8vIOWmguaenGNvbW1lbnRzVGltZWxpbmXmmK/lr7nosaHmoLzlvI/vvIzovazmjaLkuLrmlbDnu4TmoLzlvI8KICAgICAgICBjb25zdCB0aW1lbGluZUFycmF5ID0gT2JqZWN0LmVudHJpZXModGhpcy5zdGF0aXN0aWNzLmNvbW1lbnRzVGltZWxpbmUpLm1hcCgoW2RhdGUsIGNvdW50XSkgPT4gKHsKICAgICAgICAgIGRhdGUsCiAgICAgICAgICBjb3VudDogTnVtYmVyKGNvdW50KQogICAgICAgIH0pKTsKICAgICAgICAKICAgICAgICAvLyDmjInml6XmnJ/mjpLluo8KICAgICAgICB0aW1lbGluZUFycmF5LnNvcnQoKGEsIGIpID0+IG5ldyBEYXRlKGEuZGF0ZSkgLSBuZXcgRGF0ZShiLmRhdGUpKTsKICAgICAgICB0aGlzLnN0YXRpc3RpY3MuY29tbWVudHNUaW1lbGluZSA9IHRpbWVsaW5lQXJyYXk7CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMuc3RhdGlzdGljcy5jb21tZW50c1RpbWVsaW5lKSB7CiAgICAgICAgdGhpcy5zdGF0aXN0aWNzLmNvbW1lbnRzVGltZWxpbmUgPSBbXTsKICAgICAgfQogICAgfSwKICAgIGFzeW5jIGxvYWRDb21tZW50cygpIHsKICAgICAgaWYgKCF0aGlzLnNlbGVjdGVkUmVzdGF1cmFudCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICAKICAgICAgdHJ5IHsKICAgICAgICAvLyDojrflj5borqTor4Hkv6Hmga8KICAgICAgICBjb25zdCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpOwogICAgICAgIGNvbnN0IGhlYWRlcnMgPSB0b2tlbiA/IHsgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dG9rZW59YCB9IDoge307CiAgICAgICAgCiAgICAgICAgY29uc29sZS5sb2coYOato+WcqOiOt+WPlumkkOWOhUlEPSR7dGhpcy5zZWxlY3RlZFJlc3RhdXJhbnR955qE6K+E6K665YiX6KGoYCk7CiAgICAgICAgCiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXRDb21tZW50cyh0aGlzLnNlbGVjdGVkUmVzdGF1cmFudCk7CiAgICAgICAgCiAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLmNvZGUgPT09IDIwMCkgewogICAgICAgICAgbGV0IGFsbENvbW1lbnRzID0gcmVzcG9uc2UuZGF0YSB8fCBbXTsKICAgICAgICAgIAogICAgICAgICAgLy8g5oyJ5pe26Ze05LuO5paw5Yiw5pen5o6S5bqPCiAgICAgICAgICBhbGxDb21tZW50cy5zb3J0KChhLCBiKSA9PiBuZXcgRGF0ZShiLmNyZWF0ZVRpbWUpIC0gbmV3IERhdGUoYS5jcmVhdGVUaW1lKSk7CiAgICAgICAgICAKICAgICAgICAgIC8vIOagueaNrumAieWumueahOaXpeacn+iMg+WbtOetm+mAieivhOiuugogICAgICAgICAgaWYgKHRoaXMuZGF0ZVJhbmdlICYmIHRoaXMuZGF0ZVJhbmdlLmxlbmd0aCA9PT0gMikgewogICAgICAgICAgICBjb25zdCBbc3RhcnREYXRlLCBlbmREYXRlXSA9IHRoaXMuZGF0ZVJhbmdlOwogICAgICAgICAgICAvLyDorr7nva7nu5PmnZ/ml6XmnJ/kuLrlvZPlpKnmnIDlkI7kuIDmr6vnp5LvvIznoa7kv53ljIXlkKvlvZPlpKnmiYDmnInor4TorroKICAgICAgICAgICAgY29uc3QgZW5kT2ZEYXkgPSBuZXcgRGF0ZShlbmREYXRlKTsKICAgICAgICAgICAgZW5kT2ZEYXkuc2V0SG91cnMoMjMsIDU5LCA1OSwgOTk5KTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDmoLnmja7ml6XmnJ/ojIPlm7TnrZvpgInor4Torro6ICR7c3RhcnREYXRlLnRvSVNPU3RyaW5nKCl9IOiHsyAke2VuZE9mRGF5LnRvSVNPU3RyaW5nKCl9YCk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyDnrZvpgInlnKjml6XmnJ/ojIPlm7TlhoXnmoTor4TorroKICAgICAgICAgICAgdGhpcy5jb21tZW50cyA9IGFsbENvbW1lbnRzLmZpbHRlcihjb21tZW50ID0+IHsKICAgICAgICAgICAgICBpZiAoIWNvbW1lbnQuY3JlYXRlVGltZSkgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgIAogICAgICAgICAgICAgIGNvbnN0IGNvbW1lbnREYXRlID0gbmV3IERhdGUoY29tbWVudC5jcmVhdGVUaW1lKTsKICAgICAgICAgICAgICByZXR1cm4gY29tbWVudERhdGUgPj0gc3RhcnREYXRlICYmIGNvbW1lbnREYXRlIDw9IGVuZE9mRGF5OwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDnrZvpgInlkI7or4TorrrmlbA6ICR7dGhpcy5jb21tZW50cy5sZW5ndGh9LyR7YWxsQ29tbWVudHMubGVuZ3RofWApOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5jb21tZW50cyA9IGFsbENvbW1lbnRzOwogICAgICAgICAgfQogICAgICAgICAgCiAgICAgICAgICAvLyDmm7TmlrDnu5/orqHkuK3nmoTor4TorrrmlbDph48KICAgICAgICAgIHRoaXMuc3RhdGlzdGljcy50b3RhbENvbW1lbnRzID0gdGhpcy5jb21tZW50cy5sZW5ndGg7CiAgICAgICAgICAKICAgICAgICAgIGNvbnNvbGUubG9nKGDmiJDlip/liqDovb0ke3RoaXMuY29tbWVudHMubGVuZ3RofeadoeivhOiuuu+8jOW3suabtOaWsOe7n+iuoeaVsOaNrmApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCfliqDovb3or4TorrrlpLHotKU6JywgcmVzcG9uc2UpOwogICAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCdGYWlsZWQgdG8gbG9hZCBjb21tZW50cycpOwogICAgICAgICAgdGhpcy5jb21tZW50cyA9IFtdOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCfliqDovb3or4TorrrlvILluLg6JywgZXJyb3IpOwogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ0Vycm9yIGxvYWRpbmcgY29tbWVudHM6ICcgKyBlcnJvci5tZXNzYWdlKTsKICAgICAgICB0aGlzLmNvbW1lbnRzID0gW107CiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBsb2FkTWVudUl0ZW1zKCkgewogICAgICBpZiAoIXRoaXMuc2VsZWN0ZWRSZXN0YXVyYW50KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIAogICAgICB0cnkgewogICAgICAgIC8vIOiOt+WPluiupOivgeS/oeaBrwogICAgICAgIGNvbnN0IHRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJyk7CiAgICAgICAgY29uc3QgaGVhZGVycyA9IHRva2VuID8geyAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0b2tlbn1gIH0gOiB7fTsKICAgICAgICAKICAgICAgICAvLyDmt7vliqDnlKjmiLdJROWSjOinkuiJsuWIsOivt+axguWktAogICAgICAgIGhlYWRlcnNbJ1gtVXNlci1JZCddID0gdGhpcy51c2VySWQ7CiAgICAgICAgaGVhZGVyc1snWC1Vc2VyLVJvbGUnXSA9IHRoaXMudXNlclJvbGU7CiAgICAgICAgCiAgICAgICAgY29uc29sZS5sb2coYOato+WcqOiOt+WPlumkkOWOhUlEPSR7dGhpcy5zZWxlY3RlZFJlc3RhdXJhbnR955qE6I+c5Y2V6aG5YCk7CiAgICAgICAgCiAgICAgICAgLy8g5L2/55So5q2j56Gu55qEQVBJ6Lev5b6ECiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5nZXQoCiAgICAgICAgICBgaHR0cDovL2xvY2FsaG9zdDo4MDgwL21lbnUvcmVzdGF1cmFudC8ke3RoaXMuc2VsZWN0ZWRSZXN0YXVyYW50fWAsCiAgICAgICAgICB7IGhlYWRlcnMgfQogICAgICAgICk7CgogICAgICAgIGNvbnNvbGUubG9nKCdNZW51IGl0ZW1zIEFQSSByZXNwb25zZTonLCByZXNwb25zZS5kYXRhKTsKCiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEgJiYgcmVzcG9uc2UuZGF0YS5jb2RlID09PSAyMDApIHsKICAgICAgICAgIGNvbnN0IG1lbnVJdGVtcyA9IHJlc3BvbnNlLmRhdGEuZGF0YSB8fCBbXTsKICAgICAgICAgIC8vIOabtOaWsOe7n+iuoeS4reeahOiPnOWNlemhueaVsOmHjwogICAgICAgICAgdGhpcy5zdGF0aXN0aWNzLm1lbnVJdGVtQ291bnQgPSBtZW51SXRlbXMubGVuZ3RoOwogICAgICAgICAgCiAgICAgICAgICBjb25zb2xlLmxvZyhg5oiQ5Yqf5Yqg6L29JHttZW51SXRlbXMubGVuZ3RofeS4quiPnOWNlemhue+8jOW3suabtOaWsOe7n+iuoeaVsOaNrmApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCfliqDovb3oj5zljZXpobnlpLHotKU6JywgcmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ0ZhaWxlZCB0byBsb2FkIG1lbnUgaXRlbXMnKTsKICAgICAgICAgIHRoaXMuc3RhdGlzdGljcy5tZW51SXRlbUNvdW50ID0gMDsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign5Yqg6L296I+c5Y2V6aG55byC5bi4OicsIGVycm9yKTsKICAgICAgICBjb25zb2xlLmVycm9yKCLor7fmsYLlpLHotKXor6bmg4U6IiwgZXJyb3IucmVzcG9uc2UgPyBlcnJvci5yZXNwb25zZS5kYXRhIDogZXJyb3IubWVzc2FnZSk7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcignRXJyb3IgbG9hZGluZyBtZW51IGl0ZW1zOiAnICsgKGVycm9yLnJlc3BvbnNlPy5kYXRhPy5tc2cgfHwgZXJyb3IubWVzc2FnZSkpOwogICAgICAgIHRoaXMuc3RhdGlzdGljcy5tZW51SXRlbUNvdW50ID0gMDsKICAgICAgfQogICAgfSwKICAgIGZvcm1hdERhdGUoZGF0ZVN0cmluZykgewogICAgICBpZiAoIWRhdGVTdHJpbmcpIHJldHVybiAnJzsKICAgICAgCiAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShkYXRlU3RyaW5nKTsKICAgICAgcmV0dXJuIGRhdGUudG9Mb2NhbGVTdHJpbmcoKTsKICAgIH0sCiAgICBnZXRDb21tZW50Q29sb3Ioc2NvcmUpIHsKICAgICAgaWYgKCFzY29yZSkgcmV0dXJuICcjZTZhMjNjJzsKICAgICAgCiAgICAgIGNvbnN0IG51bVNjb3JlID0gTnVtYmVyKHNjb3JlKTsKICAgICAgaWYgKG51bVNjb3JlID49IDQpIHJldHVybiAnIzY3YzIzYSc7ICAvLyDlpb3or4QgLSDnu7/oibIKICAgICAgaWYgKG51bVNjb3JlID49IDIpIHJldHVybiAnI2U2YTIzYyc7ICAvLyDkuK3or4QgLSDpu4ToibIKICAgICAgcmV0dXJuICcjZjU2YzZjJzsgIC8vIOW3ruivhCAtIOe6ouiJsgogICAgfQogIH0KfTsK"},{"version":3,"sources":["RestaurantStatistics.vue"],"names":[],"mappings":";AAqKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"RestaurantStatistics.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"restaurant-statistics\">\n    <div class=\"header\">\n      <h1>Restaurant Statistics Dashboard</h1>\n      <el-button type=\"primary\" icon=\"el-icon-back\" @click=\"backToHome\">Back to Home</el-button>\n    </div>\n\n    <!-- 筛选条件 -->\n    <div class=\"filters\">\n      <el-date-picker\n        v-model=\"dateRange\"\n        type=\"daterange\"\n        range-separator=\"to\"\n        start-placeholder=\"Start Date\"\n        end-placeholder=\"End Date\"\n        :default-time=\"['00:00:00', '23:59:59']\"\n        @change=\"fetchStatistics\"\n      />\n      \n      <el-select\n        v-model=\"selectedRestaurant\"\n        placeholder=\"Select Restaurant\"\n        @change=\"fetchStatistics\"\n        class=\"restaurant-select\"\n      >\n        <el-option\n          v-for=\"restaurant in restaurants\"\n          :key=\"restaurant.id\"\n          :label=\"restaurant.name\"\n          :value=\"restaurant.id\"\n        />\n      </el-select>\n\n      <div class=\"action-buttons\">\n        <el-button type=\"primary\" @click=\"loadMockData\">Load Mock Data</el-button>\n        <el-button type=\"success\" @click=\"testAPI\">Test API</el-button>\n        <el-button type=\"info\" @click=\"logRestaurantDetails\">Log Restaurant Details</el-button>\n      </div>\n    </div>\n\n    <!-- 主要指标卡片 -->\n    <div class=\"metric-cards\">\n      <el-card class=\"metric-card\">\n        <div class=\"metric-title\">Average Rating</div>\n        <div class=\"metric-value\">\n          <span class=\"number\">{{ Number(statistics.averageRating || 0).toFixed(1) }}</span>\n          <el-rate\n            v-model=\"statistics.averageRating\"\n            disabled\n            show-score\n            text-color=\"#ff9900\"\n            score-template=\"\"\n          />\n          <span class=\"rating-count\" v-if=\"statistics.totalScores\">\n            ({{ statistics.totalScores }} ratings)\n          </span>\n        </div>\n      </el-card>\n\n      <el-card class=\"metric-card\">\n        <div class=\"metric-title\">Comments</div>\n        <div class=\"metric-value\">\n          <span class=\"number\">{{ statistics.totalComments || 0 }}</span>\n        </div>\n      </el-card>\n\n      <el-card class=\"metric-card\">\n        <div class=\"metric-title\">Menu Items</div>\n        <div class=\"metric-value\">\n          <span class=\"number\">{{ statistics.menuItemCount || 0 }}</span>\n        </div>\n      </el-card>\n\n      <el-card class=\"metric-card\">\n        <div class=\"metric-title\">Total Views</div>\n        <div class=\"metric-value\">\n          <span class=\"number\">{{ statistics.totalViews || 0 }}</span>\n        </div>\n      </el-card>\n    </div>\n\n    <!-- 图表区域 -->\n    <div class=\"charts-container\">\n      <el-row :gutter=\"20\">\n        <el-col :span=\"12\">\n          <el-card class=\"chart-card\">\n            <div slot=\"header\">Rating Distribution</div>\n            <div class=\"chart-container\">\n              <v-chart :option=\"ratingDistributionChart\" autoresize />\n            </div>\n          </el-card>\n        </el-col>\n        \n        <el-col :span=\"12\">\n          <el-card class=\"chart-card\">\n            <div slot=\"header\">Views Trend</div>\n            <div class=\"chart-container\">\n              <v-chart :option=\"viewsTrendChart\" autoresize />\n            </div>\n          </el-card>\n        </el-col>\n        \n        <el-col :span=\"12\">\n          <el-card class=\"chart-card\">\n            <div slot=\"header\">Popular Dishes</div>\n            <div class=\"chart-container\">\n              <v-chart :option=\"popularDishesChart\" autoresize />\n            </div>\n          </el-card>\n        </el-col>\n        \n        <el-col :span=\"12\">\n          <el-card class=\"chart-card\">\n            <div slot=\"header\">Comments Timeline</div>\n            <div class=\"chart-container\">\n              <v-chart :option=\"commentsTimelineChart\" autoresize />\n            </div>\n          </el-card>\n        </el-col>\n      </el-row>\n      \n      <!-- 添加评论列表展示 -->\n      <el-row>\n        <el-col :span=\"24\">\n          <el-card class=\"comments-card\">\n            <div slot=\"header\" class=\"comments-header\">\n              <span>Recent Comments</span>\n              <el-button size=\"small\" type=\"primary\" @click=\"loadComments\">Refresh Comments</el-button>\n            </div>\n            \n            <div v-if=\"comments.length === 0\" class=\"no-comments\">\n              No comments available for this restaurant.\n            </div>\n            \n            <div v-else class=\"comments-list\">\n              <el-timeline>\n                <el-timeline-item\n                  v-for=\"(comment, index) in comments\"\n                  :key=\"index\"\n                  :timestamp=\"formatDate(comment.createTime)\"\n                  :color=\"getCommentColor(comment.score)\"\n                >\n                  <el-card class=\"comment-card\">\n                    <div class=\"comment-header\">\n                      <span class=\"comment-author\">{{ comment.userName || 'Anonymous' }}</span>\n                      <el-rate\n                        v-model=\"comment.score\"\n                        disabled\n                        show-score\n                        text-color=\"#ff9900\"\n                      />\n                    </div>\n                    <div class=\"comment-content\">{{ comment.content }}</div>\n                  </el-card>\n                </el-timeline-item>\n              </el-timeline>\n            </div>\n          </el-card>\n        </el-col>\n      </el-row>\n    </div>\n  </div>\n</template>\n\n<script>\nimport ECharts from 'vue-echarts';\nimport 'echarts/lib/chart/bar';\nimport 'echarts/lib/chart/line';\nimport 'echarts/lib/chart/pie';\nimport 'echarts/lib/component/tooltip';\nimport 'echarts/lib/component/title';\nimport 'echarts/lib/component/legend';\nimport 'echarts/lib/component/grid';\nimport axios from 'axios';\nimport { getRestaurantStatistics } from '@/api/statistics'\nimport { getComments } from '@/api/index'\n\nexport default {\n  name: 'RestaurantStatistics',\n  components: {\n    'v-chart': ECharts\n  },\n  data() {\n    return {\n      dateRange: [\n        new Date(new Date().setDate(new Date().getDate() - 7)),\n        new Date()\n      ],\n      selectedRestaurant: null,\n      restaurants: [],\n      statistics: {\n        averageRating: 0,\n        totalComments: 0,\n        menuItemCount: 0,\n        totalViews: 0,\n        ratingDistribution: {},\n        viewsTrend: [],\n        popularDishes: [],\n        commentsTimeline: []\n      },\n      userRole: '',\n      userId: null,\n      comments: []\n    };\n  },\n  computed: {\n    ratingDistributionChart() {\n      const data = Object.entries(this.statistics.ratingDistribution || {}).map(\n        ([rating, count]) => ({\n          name: `${rating} Star`,\n          value: count\n        })\n      );\n\n      return {\n        tooltip: {\n          trigger: 'item',\n          formatter: '{b}: {c} ({d}%)'\n        },\n        legend: {\n          orient: 'vertical',\n          left: 'left'\n        },\n        series: [\n          {\n            type: 'pie',\n            radius: ['50%', '70%'],\n            avoidLabelOverlap: false,\n            label: {\n              show: true,\n              position: 'outside'\n            },\n            emphasis: {\n              label: {\n                show: true,\n                fontSize: '16',\n                fontWeight: 'bold'\n              }\n            },\n            labelLine: {\n              show: true\n            },\n            data: data\n          }\n        ]\n      };\n    },\n    viewsTrendChart() {\n      const { viewsTrend = [] } = this.statistics;\n      \n      // 添加日志以便调试\n      console.log('渲染趋势图表，数据格式:', typeof viewsTrend, '数据内容:', viewsTrend);\n      \n      // 确保viewsTrend是数组\n      if (!Array.isArray(viewsTrend)) {\n        console.error('viewsTrend不是数组，无法渲染图表', viewsTrend);\n        return {\n          tooltip: {\n            trigger: 'axis'\n          },\n          xAxis: {\n            type: 'category',\n            data: []\n          },\n          yAxis: {\n            type: 'value'\n          },\n          series: [\n            {\n              data: [],\n              type: 'line',\n              smooth: true,\n              areaStyle: {}\n            }\n          ]\n        };\n      }\n      \n      // 确保每个数据点都有date和views\n      const validData = viewsTrend.filter(item => item && item.date && item.views !== undefined);\n      console.log('过滤后的有效数据点:', validData.length);\n      \n      return {\n        tooltip: {\n          trigger: 'axis'\n        },\n        xAxis: {\n          type: 'category',\n          data: validData.map(item => item.date)\n        },\n        yAxis: {\n          type: 'value'\n        },\n        series: [\n          {\n            data: validData.map(item => item.views),\n            type: 'line',\n            smooth: true,\n            areaStyle: {}\n          }\n        ]\n      };\n    },\n    popularDishesChart() {\n      const { popularDishes = [] } = this.statistics;\n      return {\n        tooltip: {\n          trigger: 'axis',\n          axisPointer: {\n            type: 'shadow'\n          }\n        },\n        xAxis: {\n          type: 'value'\n        },\n        yAxis: {\n          type: 'category',\n          data: popularDishes.map(item => item.name)\n        },\n        series: [\n          {\n            type: 'bar',\n            data: popularDishes.map(item => item.orderCount)\n          }\n        ]\n      };\n    },\n    commentsTimelineChart() {\n      const { commentsTimeline = [] } = this.statistics;\n      return {\n        tooltip: {\n          trigger: 'axis'\n        },\n        xAxis: {\n          type: 'category',\n          data: commentsTimeline.map(item => item.date)\n        },\n        yAxis: {\n          type: 'value'\n        },\n        series: [\n          {\n            data: commentsTimeline.map(item => item.count),\n            type: 'line',\n            smooth: true\n          }\n        ]\n      };\n    },\n    calculateTotalRatings() {\n      if (!this.statistics.ratingDistribution) return 0;\n      return Object.values(this.statistics.ratingDistribution).reduce((a, b) => a + b, 0);\n    }\n  },\n  created() {\n    // 获取用户信息\n    this.userRole = localStorage.getItem('userRole');\n    this.userId = localStorage.getItem('userId');\n    \n    // 设置默认日期范围为最近7天\n    const end = new Date();\n    const start = new Date();\n    start.setDate(start.getDate() - 7);\n    this.dateRange = [start, end];\n    \n    // 获取餐厅列表\n    this.fetchRestaurants();\n  },\n  methods: {\n    async fetchRestaurants() {\n      try {\n        // 获取认证信息\n        const token = localStorage.getItem('token');\n        const headers = token ? { 'Authorization': `Bearer ${token}` } : {};\n        \n        // 添加用户ID和角色到请求头\n        headers['X-User-Id'] = this.userId;\n        headers['X-User-Role'] = this.userRole;\n        \n        console.log(\"加载餐厅统计列表: 当前用户角色:\", this.userRole, \"用户ID:\", this.userId);\n        \n        let response;\n        \n        if (this.userRole === 'Manager') {\n          // 管理员可以看到所有餐厅\n          response = await axios.get('http://localhost:8080/api/canteen/list', { headers });\n        } else if (this.userRole === 'Owner') {\n          // 业主只能看到自己的餐厅\n          response = await axios.get(`http://localhost:8080/api/canteen/owner/canteens`, { headers });\n        } else {\n          this.$message.warning('您的用户角色不允许访问餐厅统计信息');\n          return;\n        }\n\n        if (response && response.data && response.data.code === 200) {\n          this.restaurants = response.data.data || [];\n          console.log(`成功加载${this.restaurants.length}家餐厅用于统计`);\n          \n          if (this.restaurants.length > 0) {\n            this.selectedRestaurant = this.restaurants[0].id;\n            this.fetchStatistics();\n          } else {\n            this.$message.warning('未找到任何餐厅');\n          }\n        } else {\n          this.$message.error('加载餐厅列表失败: ' + (response?.data?.msg || '未知错误'));\n          console.error(\"加载餐厅失败:\", response?.data);\n        }\n      } catch (error) {\n        console.error('Failed to fetch restaurants:', error);\n        console.error(\"请求失败详情:\", error.response ? error.response.data : error.message);\n        this.$message.error('Failed to load restaurants: ' + (error.response?.data?.msg || error.message));\n      }\n    },\n    async fetchStatistics() {\n      if (!this.selectedRestaurant || !this.dateRange) {\n        this.$message.warning('Please select both restaurant and date range');\n        return;\n      }\n\n      const [startDate, endDate] = this.dateRange;\n      console.log('Fetching statistics for:', {\n        restaurantId: this.selectedRestaurant,\n        startDate: startDate.toISOString().split('T')[0],\n        endDate: endDate.toISOString().split('T')[0]\n      });\n\n      try {\n        // 获取认证信息\n        const token = localStorage.getItem('token');\n        const headers = token ? { 'Authorization': `Bearer ${token}` } : {};\n        \n        // 添加用户ID和角色到请求头\n        headers['X-User-Id'] = this.userId;\n        headers['X-User-Role'] = this.userRole;\n        \n        console.log(`正在获取餐厅ID=${this.selectedRestaurant}的统计数据`);\n        \n        // 根据后端StatisticsController的路径调整URL\n        const response = await axios({\n          method: 'get',\n          url: 'http://localhost:8080/statistics/canting',\n          params: {\n            canteenId: this.selectedRestaurant,\n            startDate: startDate.toISOString().split('T')[0],\n            endDate: endDate.toISOString().split('T')[0]\n          },\n          headers\n        });\n\n        console.log('Raw API response:', response.data);\n\n        if (response.data && response.data.code === 200) {\n          this.statistics = response.data.data || {};\n          // Ensure averageRating is a number\n          this.statistics.averageRating = Number(this.statistics.averageRating || 0);\n          \n          // 确保所有必要的统计字段都存在，避免空指针\n          this.ensureStatisticsStructure();\n          \n          console.log('Processed statistics:', this.statistics);\n          \n          // 加载评论\n          this.loadComments();\n          \n          // 加载菜单项\n          this.loadMenuItems();\n        } else {\n          console.error('API error:', response.data);\n          this.$message.error(response.data?.msg || 'Failed to load statistics');\n          \n          // 如果获取失败，初始化空数据\n          this.resetStatistics();\n        }\n      } catch (error) {\n        console.error('Failed to fetch statistics:', error);\n        console.error(\"请求失败详情:\", error.response ? error.response.data : error.message);\n        this.$message.error('Failed to load statistics: ' + (error.response?.data?.msg || error.message));\n        \n        // 如果错误，初始化空数据\n        this.resetStatistics();\n      }\n    },\n    loadMockData() {\n      this.statistics = {\n        averageRating: 4.4,\n        totalComments: 15,\n        menuItemCount: 24,\n        totalViews: 4079,\n        ratingDistribution: {\n          '1 Star': 5,\n          '2 Stars': 10,\n          '3 Stars': 20,\n          '4 Stars': 40,\n          '5 Stars': 25\n        },\n        viewsTrend: Array.from({ length: 7 }, (_, i) => ({\n          date: new Date(Date.now() - (6 - i) * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\n          views: Math.floor(Math.random() * 100) + 50\n        })),\n        popularDishes: [\n          { name: 'Dish 1', orderCount: 45 },\n          { name: 'Dish 2', orderCount: 38 },\n          { name: 'Dish 3', orderCount: 32 },\n          { name: 'Dish 4', orderCount: 25 },\n          { name: 'Dish 5', orderCount: 20 }\n        ],\n        commentsTimeline: Array.from({ length: 7 }, (_, i) => ({\n          date: new Date(Date.now() - (6 - i) * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\n          count: Math.floor(Math.random() * 10)\n        }))\n      };\n      \n      // 生成模拟评论数据\n      this.comments = [\n        {\n          id: 1,\n          userName: 'John Doe',\n          content: 'Great food and excellent service! Will definitely come back again.',\n          score: 5,\n          createTime: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString()\n        },\n        {\n          id: 2,\n          userName: 'Alice Smith',\n          content: 'Food was good but the wait time was a bit long.',\n          score: 4, \n          createTime: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000).toISOString()\n        },\n        {\n          id: 3,\n          userName: 'Bob Johnson',\n          content: 'Average experience. Nothing special.',\n          score: 3,\n          createTime: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString()\n        },\n        {\n          id: 4,\n          userName: 'Emma Wilson',\n          content: 'Disappointed with the quality of food. Not worth the price.',\n          score: 2,\n          createTime: new Date(Date.now() - 6 * 24 * 60 * 60 * 1000).toISOString()\n        },\n        {\n          id: 5,\n          userName: 'Michael Brown',\n          content: 'Terrible experience! Food was cold and service was rude.',\n          score: 1,\n          createTime: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString()\n        }\n      ];\n    },\n    async testAPI() {\n      try {\n        // 获取认证信息\n        const token = localStorage.getItem('token');\n        const headers = token ? { 'Authorization': `Bearer ${token}` } : {};\n        \n        // 添加用户ID和角色到请求头\n        headers['X-User-Id'] = this.userId;\n        headers['X-User-Role'] = this.userRole;\n        \n        console.log('Testing statistics API...');\n        \n        const response = await axios.get('http://localhost:8080/api/statistics/test', { headers });\n        \n        if (response.data && response.data.code === 200) {\n          this.$message.success('API test successful');\n          console.log('API测试响应:', response.data);\n        } else {\n          this.$message.warning('API test returned unexpected response');\n          console.warn('API测试意外响应:', response.data);\n        }\n      } catch (error) {\n        console.error('API test failed:', error);\n        console.error(\"请求失败详情:\", error.response ? error.response.data : error.message);\n        this.$message.error('API test failed: ' + (error.response?.data?.msg || error.message));\n      }\n    },\n    logRestaurantDetails() {\n      console.log('Current Statistics:', this.statistics);\n      console.log('Selected Restaurant:', this.selectedRestaurant);\n      console.log('Date Range:', this.dateRange);\n    },\n    backToHome() {\n      this.$router.push('/');\n    },\n    // 重置统计数据为默认空值\n    resetStatistics() {\n      this.statistics = {\n        averageRating: 0,\n        totalComments: 0,\n        menuItemCount: 0,\n        totalViews: 0,\n        ratingDistribution: {},\n        viewsTrend: [],\n        popularDishes: [],\n        commentsTimeline: []\n      };\n    },\n    // 确保所有必要的统计字段都存在\n    ensureStatisticsStructure() {\n      if (!this.statistics) this.statistics = {};\n      \n      this.statistics.averageRating = Number(this.statistics.averageRating || 0);\n      this.statistics.totalComments = this.statistics.totalComments || 0;\n      this.statistics.menuItemCount = this.statistics.menuItemCount || 0;\n      this.statistics.totalViews = this.statistics.totalViews || 0;\n      \n      // 处理评分分布数据\n      if (this.statistics.ratingDistribution && typeof this.statistics.ratingDistribution === 'object') {\n        console.log('处理评分分布数据:', this.statistics.ratingDistribution);\n        \n        // 确保评分分布的键是字符串格式如 \"1 Star\", \"2 Stars\" 等\n        const formattedDistribution = {};\n        Object.entries(this.statistics.ratingDistribution).forEach(([rating, count]) => {\n          const stars = Number(rating);\n          if (!isNaN(stars)) {\n            formattedDistribution[`${stars} Star${stars > 1 ? 's' : ''}`] = count;\n          } else {\n            formattedDistribution[rating] = count;\n          }\n        });\n        \n        this.statistics.ratingDistribution = formattedDistribution;\n      } else {\n        this.statistics.ratingDistribution = {};\n      }\n      \n      // 处理viewsTrend：将对象格式转换为数组格式\n      if (this.statistics.viewsTrend && typeof this.statistics.viewsTrend === 'object' && !Array.isArray(this.statistics.viewsTrend)) {\n        // 如果viewsTrend是对象格式(后端返回的格式)，转换为数组格式\n        console.log('转换viewsTrend格式，从对象到数组:', this.statistics.viewsTrend);\n        \n        const trendArray = Object.entries(this.statistics.viewsTrend).map(([date, views]) => ({\n          date,\n          views: Number(views)\n        }));\n        \n        // 按日期排序\n        trendArray.sort((a, b) => new Date(a.date) - new Date(b.date));\n        this.statistics.viewsTrend = trendArray;\n        \n        console.log('转换后的viewsTrend:', this.statistics.viewsTrend);\n      } else if (!this.statistics.viewsTrend) {\n        this.statistics.viewsTrend = [];\n      }\n      \n      // 确保popularDishes是数组\n      if (!Array.isArray(this.statistics.popularDishes)) {\n        this.statistics.popularDishes = [];\n      }\n      \n      // 确保commentsTimeline是数组\n      if (this.statistics.commentsTimeline && typeof this.statistics.commentsTimeline === 'object' && !Array.isArray(this.statistics.commentsTimeline)) {\n        // 如果commentsTimeline是对象格式，转换为数组格式\n        const timelineArray = Object.entries(this.statistics.commentsTimeline).map(([date, count]) => ({\n          date,\n          count: Number(count)\n        }));\n        \n        // 按日期排序\n        timelineArray.sort((a, b) => new Date(a.date) - new Date(b.date));\n        this.statistics.commentsTimeline = timelineArray;\n      } else if (!this.statistics.commentsTimeline) {\n        this.statistics.commentsTimeline = [];\n      }\n    },\n    async loadComments() {\n      if (!this.selectedRestaurant) {\n        return;\n      }\n      \n      try {\n        // 获取认证信息\n        const token = localStorage.getItem('token');\n        const headers = token ? { 'Authorization': `Bearer ${token}` } : {};\n        \n        console.log(`正在获取餐厅ID=${this.selectedRestaurant}的评论列表`);\n        \n        const response = await getComments(this.selectedRestaurant);\n        \n        if (response && response.code === 200) {\n          let allComments = response.data || [];\n          \n          // 按时间从新到旧排序\n          allComments.sort((a, b) => new Date(b.createTime) - new Date(a.createTime));\n          \n          // 根据选定的日期范围筛选评论\n          if (this.dateRange && this.dateRange.length === 2) {\n            const [startDate, endDate] = this.dateRange;\n            // 设置结束日期为当天最后一毫秒，确保包含当天所有评论\n            const endOfDay = new Date(endDate);\n            endOfDay.setHours(23, 59, 59, 999);\n            \n            console.log(`根据日期范围筛选评论: ${startDate.toISOString()} 至 ${endOfDay.toISOString()}`);\n            \n            // 筛选在日期范围内的评论\n            this.comments = allComments.filter(comment => {\n              if (!comment.createTime) return false;\n              \n              const commentDate = new Date(comment.createTime);\n              return commentDate >= startDate && commentDate <= endOfDay;\n            });\n            \n            console.log(`筛选后评论数: ${this.comments.length}/${allComments.length}`);\n          } else {\n            this.comments = allComments;\n          }\n          \n          // 更新统计中的评论数量\n          this.statistics.totalComments = this.comments.length;\n          \n          console.log(`成功加载${this.comments.length}条评论，已更新统计数据`);\n        } else {\n          console.error('加载评论失败:', response);\n          this.$message.warning('Failed to load comments');\n          this.comments = [];\n        }\n      } catch (error) {\n        console.error('加载评论异常:', error);\n        this.$message.error('Error loading comments: ' + error.message);\n        this.comments = [];\n      }\n    },\n    async loadMenuItems() {\n      if (!this.selectedRestaurant) {\n        return;\n      }\n      \n      try {\n        // 获取认证信息\n        const token = localStorage.getItem('token');\n        const headers = token ? { 'Authorization': `Bearer ${token}` } : {};\n        \n        // 添加用户ID和角色到请求头\n        headers['X-User-Id'] = this.userId;\n        headers['X-User-Role'] = this.userRole;\n        \n        console.log(`正在获取餐厅ID=${this.selectedRestaurant}的菜单项`);\n        \n        // 使用正确的API路径\n        const response = await axios.get(\n          `http://localhost:8080/menu/restaurant/${this.selectedRestaurant}`,\n          { headers }\n        );\n\n        console.log('Menu items API response:', response.data);\n\n        if (response.data && response.data.code === 200) {\n          const menuItems = response.data.data || [];\n          // 更新统计中的菜单项数量\n          this.statistics.menuItemCount = menuItems.length;\n          \n          console.log(`成功加载${menuItems.length}个菜单项，已更新统计数据`);\n        } else {\n          console.error('加载菜单项失败:', response.data);\n          this.$message.warning('Failed to load menu items');\n          this.statistics.menuItemCount = 0;\n        }\n      } catch (error) {\n        console.error('加载菜单项异常:', error);\n        console.error(\"请求失败详情:\", error.response ? error.response.data : error.message);\n        this.$message.error('Error loading menu items: ' + (error.response?.data?.msg || error.message));\n        this.statistics.menuItemCount = 0;\n      }\n    },\n    formatDate(dateString) {\n      if (!dateString) return '';\n      \n      const date = new Date(dateString);\n      return date.toLocaleString();\n    },\n    getCommentColor(score) {\n      if (!score) return '#e6a23c';\n      \n      const numScore = Number(score);\n      if (numScore >= 4) return '#67c23a';  // 好评 - 绿色\n      if (numScore >= 2) return '#e6a23c';  // 中评 - 黄色\n      return '#f56c6c';  // 差评 - 红色\n    }\n  }\n};\n</script>\n\n<style scoped>\n.restaurant-statistics {\n  padding: 20px;\n  background-color: #f5f7fa;\n  min-height: 100vh;\n}\n\n.header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.header h1 {\n  margin: 0;\n  color: #303133;\n}\n\n.filters {\n  display: flex;\n  gap: 20px;\n  margin-bottom: 20px;\n  align-items: center;\n  flex-wrap: wrap;\n}\n\n.restaurant-select {\n  min-width: 200px;\n}\n\n.action-buttons {\n  margin-left: auto;\n  display: flex;\n  gap: 10px;\n}\n\n.metric-cards {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n  gap: 20px;\n  margin-bottom: 20px;\n}\n\n.metric-card {\n  text-align: center;\n  padding: 20px;\n}\n\n.metric-title {\n  color: #909399;\n  font-size: 14px;\n  margin-bottom: 10px;\n}\n\n.metric-value {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 10px;\n}\n\n.metric-value .number {\n  font-size: 32px;\n  font-weight: bold;\n  color: #303133;\n}\n\n.metric-value .rating-count {\n  font-size: 14px;\n  color: #909399;\n}\n\n.metric-value :deep(.el-rate) {\n  display: flex;\n  justify-content: center;\n  margin: 5px 0;\n}\n\n.metric-value :deep(.el-rate__icon) {\n  font-size: 20px;\n  margin-right: 4px;\n}\n\n.charts-container {\n  margin-top: 20px;\n}\n\n.chart-card {\n  margin-bottom: 20px;\n}\n\n.chart-container {\n  height: 300px;\n  width: 100%;\n}\n\n:deep(.el-card__header) {\n  padding: 15px 20px;\n  font-weight: bold;\n  color: #303133;\n}\n\n:deep(.el-date-editor.el-input),\n:deep(.el-date-editor.el-input__inner) {\n  width: 320px;\n}\n\n.comments-card {\n  margin-top: 20px;\n}\n\n.comments-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.no-comments {\n  text-align: center;\n  padding: 20px;\n  color: #999;\n  font-style: italic;\n}\n\n.comments-list {\n  max-height: 400px;\n  overflow-y: auto;\n}\n\n.comment-card {\n  margin-bottom: 10px;\n}\n\n.comment-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8px;\n}\n\n.comment-author {\n  font-weight: bold;\n  font-size: 16px;\n}\n\n.comment-content {\n  font-size: 14px;\n  line-height: 1.5;\n  white-space: pre-line;\n}\n</style> "]}]}